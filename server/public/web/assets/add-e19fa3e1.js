import{e as ee,a8 as le,r as b,a2 as te,P as i,a3 as p,a4 as o,f as l,I as r,Q as g,F as U,aa as C,H as V,a9 as v,a7 as $,ac as ae,ad as oe}from"./vue-bf422dc1.js";import{l as ne}from"./category-c9a07555.js";import{g as ue,d as de,a as ie,e as se}from"./good-954eccf9.js";import{T as w,S as me,C as re,I as pe,a as _e,b as ve}from"./constant-755fa812.js";import{M as q,m as ce,d as fe,F as ye,I as ge,h as Ve,Y as he,S as be,B as we,O as ke,g as xe,W as Ue,e as Ce,b as Se}from"./ui-ba7aaa7e.js";import{_ as Ie}from"./index-8db2df2c.js";import"./icons-a8498fb6.js";import"./libs-51817cd7.js";import"./plugins-ca970193.js";import"./others-9f318174.js";import"./echarts-bf9d612c.js";const qe=k=>(ae("data-v-4e71be35"),k=k(),oe(),k),Ne={class:"more-setting"},Re=qe(()=>$("span",{class:"more-sett-text"},"显示更多高级设置",-1)),Te={key:4,class:"more-content"},Ae={name:"GoodsAdd"},Ee=ee({...Ae,setup(k){const c=le(),N=b("add"),e=b({cate_id:"",name:"",price:"",can_proxy:0,proxy_price:"",proxy_price_add:"",event_give:[],addtion_give:[],sms_payer:0,cost_price:"",limit_quantity:"",limit_quantity_max:"",inventory_notify:1,card_order:0,selectcard_fee:"",coupon_type:0,sold_notify:0,inventory_notify_type:1,take_card_type:0,contact_limit:"mobile",content:"",remark:"",sort:"0",wholesale_discount:0,wholesale_discount_list:[],theme:"default"}),x=b([]),D=async()=>{const{data:n}=await ue();c.currentRoute.value.query.id?x.value=n.filter(a=>a.id!=c.currentRoute.value.query.id):x.value=n},R=n=>{if(n&&x.value.length<2){q.warning("至少要有两个商品才能开启附加赠送");return}n?e.value.addtion_give.push({good_id:"",bug_num:"",give_num:""}):e.value.addtion_give=[]},L=n=>{e.value.addtion_give.splice(n,1),e.value.addtion_give.length===0&&(e.value.addtion_give=[])},T=n=>{n?e.value.event_give.push({num:"",give_num:""}):e.value.event_give=[]},P=n=>{e.value.event_give.splice(n,1),e.value.event_give.length===0&&(e.value.event_give=[])},A=n=>{n?e.value.wholesale_discount_list.push({num:"",price:""}):e.value.wholesale_discount_list=[]},Y=n=>{e.value.wholesale_discount_list.splice(n,1),e.value.wholesale_discount_list.length===0&&(e.value.wholesale_discount=0)},E=b("添加商品"),M=async()=>{if(c.currentRoute.value.query.id)try{const{data:n}=await de({id:c.currentRoute.value.query.id});e.value={...n},N.value="edit",E.value="编辑商品"}catch(n){console.log(n)}},B=b([]),W=async()=>{const{data:n}=await ne();if(n.list.length===0){const a=ce({header:"提醒",body:"还没有商品分类，请先添加分类！",confirmBtn:"去分类页添加",closeOnOverlayClick:!1,theme:"warning",onConfirm:({e:s})=>{a.hide(),c.push("/merchant/goods/category")},onCloseBtnClick:({e:s})=>{a.hide(),c.push("/merchant/goods/category")},onCancel:({e:s})=>{a.hide(),c.push("/merchant/goods/category")}})}B.value=n.list},S=b(!1),H={cate_id:[{required:!0,message:"请选择分类",type:"error"}],name:[{required:!0,message:"请输入商品名",type:"error"}],price:[{required:!0,message:"请输入商品价格",type:"error"}],content:[{required:!0,message:"请输入商品详情",type:"error"}],remark:[{required:!0,message:"请输入商品备注",type:"error"}]},z=b(),F=async()=>{const n=await z.value.validate();if(typeof n!="object"&&n){const a=e.value;try{let s;N.value==="add"?s=await ie(a):s=await se(a),s.code===1?q.success(s.msg):q.error(`提交失败：${s.msg}`)}catch(s){console.error(s)}}},j=async()=>{F(),c.push("/merchant/goods/index")};return W(),M(),D(),(n,a)=>{const s=fe,u=ye,I=ge,_=Ve,O=he,h=be,m=te("wp-check-tag"),f=we,K=ke,G=xe,Q=Ue,J=Ce,X=Se;return i(),p(X,{title:E.value,class:"basic-container",bordered:!1},{default:o(()=>[l(J,{ref_key:"form",ref:z,class:"base-form",data:e.value,rules:H,"label-align":"left","label-width":150,"scroll-to-first-error":"smooth","status-icon":"",onSubmit:F},{default:o(()=>[l(u,{label:"商品分类",name:"cate_id"},{default:o(()=>[l(s,{modelValue:e.value.cate_id,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.cate_id=t),placeholder:"请选择商品分类",size:"medium",style:{width:"600px"},options:B.value},null,8,["modelValue","options"])]),_:1}),l(u,{label:"商品名称",name:"name",tips:"输入商品名称，长度需在2-20位之间"},{default:o(()=>[l(I,{modelValue:e.value.name,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.name=t),maxlength:20,"show-limit-number":"",placeholder:"请输入商品名称",size:"medium",style:{width:"600px"}},null,8,["modelValue"])]),_:1}),l(u,{label:"销售价格",name:"price",tips:"必填，输入销售价格，范围在0.1-20000"},{default:o(()=>[l(O,{append:"元"},{default:o(()=>[l(_,{modelValue:e.value.price,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.price=t),max:2e4,min:.1,"decimal-places":2,placeholder:"请输入销售价格",theme:"normal",size:"medium"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{label:"成本价格",name:"cost_price",tips:"商品成本价不可高于商品价格！（成本价，方便统计）"},{default:o(()=>[l(O,{append:"元"},{default:o(()=>[l(_,{modelValue:e.value.cost_price,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.cost_price=t),"decimal-places":2,placeholder:"请输入成本价",theme:"normal",size:"medium"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{label:"限购设置",name:"event_give"},{default:o(()=>[l(h,null,{default:o(()=>[l(_,{modelValue:e.value.limit_quantity,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.limit_quantity=t),theme:"normal",align:"center",label:"最少购买",suffix:"件",placeholder:"请输入最少购买数量",style:{width:"292px"},size:"medium"},null,8,["modelValue"]),l(_,{modelValue:e.value.limit_quantity_max,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.limit_quantity_max=t),theme:"normal",align:"center",label:"最多购买",suffix:"件",placeholder:"请输入最多购买数量",style:{width:"292px"},size:"medium"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{label:"优惠券",name:"coupon_type",tips:"选择开启则表示该商品可以使用优惠券"},{default:o(()=>[l(m,{modelValue:e.value.coupon_type,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.coupon_type=t),items:r(w)},null,8,["modelValue","items"])]),_:1}),l(u,{label:"活动赠送",name:"event_give",tips:""},{default:o(()=>[l(m,{modelValue:e.value.event_give,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.event_give=t),items:r(w),onActions:T},null,8,["modelValue","items"])]),_:1}),e.value.event_give.length?(i(),p(u,{key:0,label:"",name:"event_give"},{default:o(()=>[l(h,{direction:"vertical"},{default:o(()=>[(i(!0),g(U,null,C(e.value.event_give,(t,y)=>(i(),g("div",{key:y},[l(h,null,{default:o(()=>[l(_,{modelValue:t.num,"onUpdate:modelValue":d=>t.num=d,theme:"normal",align:"center",label:"买满：",suffix:"件",placeholder:"请输入买满数量",style:{width:"292px"}},null,8,["modelValue","onUpdate:modelValue"]),l(_,{modelValue:t.give_num,"onUpdate:modelValue":d=>t.give_num=d,theme:"normal",align:"center",label:"赠送：",suffix:"件",placeholder:"请输入赠送数量",style:{width:"292px"}},null,8,["modelValue","onUpdate:modelValue"]),l(f,{theme:"danger",variant:"outline",onClick:d=>P(y)},{default:o(()=>[V("删除")]),_:2},1032,["onClick"]),e.value.event_give.length?(i(),p(f,{key:0,variant:"outline",theme:"primary",onClick:a[8]||(a[8]=d=>T(1))},{default:o(()=>[V(" 添加 ")]),_:1})):v("",!0)]),_:2},1024)]))),128))]),_:1})]),_:1})):v("",!0),l(u,{label:"附加赠送",name:"addtion_give",tips:""},{default:o(()=>[l(m,{modelValue:e.value.addtion_give,"onUpdate:modelValue":a[9]||(a[9]=t=>e.value.addtion_give=t),items:r(w),onActions:R},null,8,["modelValue","items"])]),_:1}),e.value.addtion_give.length?(i(),p(u,{key:1,label:"",name:"addtion_give",tips:"若编辑（B商品，2,1）意思为买2个当前商品送B商品1个"},{default:o(()=>[e.value.addtion_give.length?(i(),p(h,{key:0,direction:"vertical"},{default:o(()=>[(i(!0),g(U,null,C(e.value.addtion_give,(t,y)=>(i(),g("div",{key:y},[l(h,null,{default:o(()=>[l(s,{modelValue:t.good_id,"onUpdate:modelValue":d=>t.good_id=d,style:{width:"292px"},placeholder:"请选择商品"},{default:o(()=>[(i(!0),g(U,null,C(x.value,(d,Z)=>(i(),p(K,{key:Z,value:d.id,label:d.name},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(I,{modelValue:t.bug_num,"onUpdate:modelValue":d=>t.bug_num=d,placeholder:"请输入购买数量",type:"number",theme:"normal","decimal-places":!1,min:1,style:{width:"138px"}},null,8,["modelValue","onUpdate:modelValue"]),l(I,{modelValue:t.give_num,"onUpdate:modelValue":d=>t.give_num=d,placeholder:"请输入赠送数量",type:"number",theme:"normal","decimal-places":!1,min:1,style:{width:"138px"}},null,8,["modelValue","onUpdate:modelValue"]),l(f,{theme:"danger",variant:"outline",onClick:d=>L(y)},{default:o(()=>[V("删除")]),_:2},1032,["onClick"]),e.value.addtion_give.length?(i(),p(f,{key:0,variant:"outline",theme:"primary",onClick:a[10]||(a[10]=d=>R(1))},{default:o(()=>[V(" 添加 ")]),_:1})):v("",!0)]),_:2},1024)]))),128))]),_:1})):v("",!0)]),_:1})):v("",!0),l(u,{label:"批发优惠",name:"wholesale_discount_list",tips:""},{default:o(()=>[l(m,{modelValue:e.value.wholesale_discount_list,"onUpdate:modelValue":a[11]||(a[11]=t=>e.value.wholesale_discount_list=t),items:r(w),onActions:A},null,8,["modelValue","items"])]),_:1}),e.value.wholesale_discount_list.length?(i(),p(u,{key:2,label:"",name:"wholesale_discount_list"},{default:o(()=>[l(h,{direction:"vertical"},{default:o(()=>[(i(!0),g(U,null,C(e.value.wholesale_discount_list,(t,y)=>(i(),g("div",{key:y},[l(h,null,{default:o(()=>[l(_,{modelValue:t.num,"onUpdate:modelValue":d=>t.num=d,theme:"normal",align:"right",label:"数量：",suffix:"件",placeholder:"请输入购买数量",style:{width:"290px"}},null,8,["modelValue","onUpdate:modelValue"]),l(_,{modelValue:t.price,"onUpdate:modelValue":d=>t.price=d,theme:"normal",align:"right",label:"价格：",suffix:"元",placeholder:"请输入价格",style:{width:"290px"}},null,8,["modelValue","onUpdate:modelValue"]),l(f,{theme:"danger",variant:"outline",onClick:d=>Y(y)},{default:o(()=>[V("删除")]),_:2},1032,["onClick"]),e.value.wholesale_discount_list.length?(i(),p(f,{key:0,variant:"outline",theme:"primary",onClick:a[12]||(a[12]=d=>A(1))},{default:o(()=>[V(" 添加 ")]),_:1})):v("",!0)]),_:2},1024)]))),128))]),_:1})]),_:1})):v("",!0),l(u,{label:"短信费用",name:"sms_payer",tips:"选择由买家或者商家承担平台服务费。默认买家承担"},{default:o(()=>[l(m,{modelValue:e.value.sms_payer,"onUpdate:modelValue":a[13]||(a[13]=t=>e.value.sms_payer=t),items:r(me)},null,8,["modelValue","items"])]),_:1}),l(u,{label:"售卡顺序",name:"card_order"},{default:o(()=>[l(m,{modelValue:e.value.card_order,"onUpdate:modelValue":a[14]||(a[14]=t=>e.value.card_order=t),items:r(re)},null,8,["modelValue","items"])]),_:1}),l(u,{label:"售出通知",name:"sold_notify",tips:""},{default:o(()=>[l(m,{modelValue:e.value.sold_notify,"onUpdate:modelValue":a[15]||(a[15]=t=>e.value.sold_notify=t),items:r(w)},null,8,["modelValue","items"])]),_:1}),e.value.sold_notify?(i(),p(u,{key:3,span:8,label:"通知方式",name:"inventory_notify_type",tips:"默认站内信通知，邮件和微信通知需要绑定对应关系",class:"notify_type"},{default:o(()=>[l(m,{modelValue:e.value.inventory_notify_type,"onUpdate:modelValue":a[16]||(a[16]=t=>e.value.inventory_notify_type=t),items:r(pe)},null,8,["modelValue","items"])]),_:1})):v("",!0),l(u,{label:"提卡密码",name:"take_card_type",tips:"开启后，购买页面会提示买家填写取卡密码"},{default:o(()=>[l(m,{modelValue:e.value.take_card_type,"onUpdate:modelValue":a[17]||(a[17]=t=>e.value.take_card_type=t),items:r(_e)},null,8,["modelValue","items"])]),_:1}),l(u,{label:"联系方式",name:"contact_limit",tips:""},{default:o(()=>[l(m,{modelValue:e.value.contact_limit,"onUpdate:modelValue":a[18]||(a[18]=t=>e.value.contact_limit=t),items:r(ve)},null,8,["modelValue","items"])]),_:1}),l(u,{label:"商品描述",name:"content",tips:"必填，商品描述会在买家选择商品时展示，建议写上您商品的简介，官网以及常见的问题",style:{width:"760px"}},{default:o(()=>[l(G,{modelValue:e.value.content,"onUpdate:modelValue":a[19]||(a[19]=t=>e.value.content=t),placeholder:"商品描述会在买家选择商品时展示，建议写上您商品的简介，官网以及常见的问题，请保持在10-500字之间",size:"medium"},null,8,["modelValue"])]),_:1}),l(u,{label:"使用说明",name:"remark",tips:"必填，商品使用说明会在买家购买完成后展示，建议写上您的产品使用说明，售后联系方式等",style:{width:"760px"}},{default:o(()=>[l(G,{modelValue:e.value.remark,"onUpdate:modelValue":a[20]||(a[20]=t=>e.value.remark=t),placeholder:"请输入使用说明",size:"medium"},null,8,["modelValue"])]),_:1}),$("div",Ne,[l(Q,{modelValue:S.value,"onUpdate:modelValue":a[21]||(a[21]=t=>S.value=t)},null,8,["modelValue"]),Re]),S.value?(i(),g("div",Te,[l(u,{label:"库存预警",name:"inventory_notify",tips:"设置后请确保邮箱正确，否则无法接收邮件"},{default:o(()=>[l(m,{modelValue:e.value.inventory_notify,"onUpdate:modelValue":a[22]||(a[22]=t=>e.value.inventory_notify=t),items:r(w)},null,8,["modelValue","items"])]),_:1}),l(u,{label:"商品排序",name:"sort",tips:""},{default:o(()=>[l(_,{modelValue:e.value.sort,"onUpdate:modelValue":a[23]||(a[23]=t=>e.value.sort=t),min:0,theme:"normal",placeholder:"",style:{width:"600px"},size:"medium"},null,8,["modelValue"])]),_:1})])):v("",!0),l(u,null,{default:o(()=>[l(f,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:o(()=>[V(" 提交 ")]),_:1}),l(f,{theme:"default",class:"form-submit-confirm",onClick:j},{default:o(()=>[V(" 提交并返回至商品列表 ")]),_:1})]),_:1})]),_:1},8,["data"])]),_:1},8,["title"])}}});const We=Ie(Ee,[["__scopeId","data-v-4e71be35"]]);export{We as default};
