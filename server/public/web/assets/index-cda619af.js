import{g as X,e as Y}from"./config-2935dafc.js";import{r as f,u as Z,c as I,_ as ee}from"./index-b0aabda4.js";import{p as te}from"./global-0d825ba6.js";import{_ as ae,c as ne}from"./search.vue_vue_type_script_setup_true_lang-ff12696a.js";import{m as B,M as c,I as oe,n as se,o as ie,B as ce,S as le,p as re,L as de,j as ue,b as me}from"./ui-ba7aaa7e.js";import{e as fe,r as u,d as pe,l as he,M as _e,P as l,Q as v,a7 as S,A as g,a3 as y,a4 as n,f as s,F as ve,aa as ge,H as r,ab as x,I as z,a9 as P,h as ye}from"./vue-bf422dc1.js";import"./libs-51817cd7.js";import"./plugins-ca970193.js";import"./others-9f318174.js";import"./echarts-bf9d612c.js";import"./icons-a8498fb6.js";import"./date-20546ee0.js";function Ce(i){return f.post({url:"/adminapi/merchant/cash/list",params:i})}function ke(){return f.post({url:"/adminapi/merchant/cash/cashCount"})}function be(i){return f.post({url:"/adminapi/merchant/cash/del",params:i})}function xe(i){return f.post({url:"/adminapi/merchant/cash/delBatch",params:i})}function we(i){return f.post({url:"/adminapi/merchant/cash/refuse",params:i})}function De(i){return f.post({url:"/adminapi/merchant/cash/pass",params:i})}function Be(i){return f.post({url:"/adminapi/merchant/cash/autoPass",params:i})}const Se={class:"basic-container"},ze={style:{padding:"15px"}},Pe={class:"category-header c-flex"},Re={class:"category-header c-flex"},Ne={class:"l"},$e={key:0,class:"selected-count"},Ie={key:0},Te={key:1},Ve={key:2},Ae=fe({__name:"index",setup(i){const m=u([]),M=t=>{m.value=t},O=async()=>{const t=B({header:"提醒",body:"是否确认删除？",confirmBtn:"确认",onConfirm:()=>{t.hide();const e={ids:m.value};xe(e).then(a=>{a.code===1?(d(),c.success(a.msg),m.value=[]):c.error(a.msg)})},onClose:()=>{t.hide()}})},T=u(5),V=u([]);(async()=>{const{data:t}=await ke();V.value=t})();const p=u({defaultPageSize:20,total:0,defaultCurrent:1}),R=u([]),A=u(),d=async(t={})=>{A.value=t;const{data:e}=await Ce({page:p.value.defaultCurrent,limit:p.value.defaultPageSize,...t});R.value=e.list,p.value.total=e.total};d();const j=t=>{p.value.defaultCurrent=t.current,p.value.defaultPageSize=t.pageSize,d(A)},F=Z(),J=pe(()=>({offsetTop:F.isUseTabsRouter?48:0,container:`.${te}-layout`})),w=u([""]),K=async t=>{w.value.includes(t)?w.value=[]:w.value=[t];const e=B.confirm({header:"是否确认打款",body:"是否确认提交？",confirmBtn:{content:"提交",theme:"primary",loading:!1},theme:"warning",onConfirm:()=>{e.update({confirmBtn:{content:"提交中",loading:!0}}),De({id:t}).then(a=>{a.code===1?(c.success("操作成功"),e.hide(),d()):c.error(a.msg)})}})},N=u(""),q=async t=>{const e=B.confirm({header:"请输入驳回原因",body:()=>ye(oe,{onInput:a=>{N.value=a.target.value},placeholder:"请输入驳回原因"}),confirmBtn:{content:"提交",theme:"primary",loading:!1},onConfirm:()=>{e.update({confirmBtn:{content:"提交中",loading:!0}}),we({id:t,reason:N.value}).then(a=>{a.code===1?(c.success("操作成功"),N.value="",e.hide(),d()):c.error(a.msg)})}})},E=async(t,e)=>{const a=B.confirm({header:"是否确认全自动打款",body:"是否确认提交？",confirmBtn:{content:"提交",theme:"primary",loading:!1},theme:"warning",onConfirm:()=>{a.update({confirmBtn:{content:"提交中",loading:!0}}),Be({id:e,type:t}).then(k=>{k.code===1?(c.success("操作成功"),a.hide(),d()):c.error(k.msg)})}})},H=async t=>{const e=await be({id:t});e.code===1?(c.success("删除成功"),d()):c.error(e.msg)},C=he({cash_weixinnotify_open:0,cash_emailnotify_open:0}),L=async()=>{const{data:t}=await X({field:Object.keys(C)});for(const e in t)C[e]=t[e]};L();const Q=async t=>{const e=JSON.parse(JSON.stringify(C));e[t]=e[t]===1?0:1;const a=await Y({data:{...e}});a.code===1?(c.success("操作成功"),L()):c.error(a.msg)};return(t,e)=>{const a=se,k=ie,D=ce,$=le,U=re,h=de,G=ue,W=me,_=_e("perms");return l(),v("div",Se,[S("div",ze,[g((l(),y($,null,{default:n(()=>[s(k,{title:"统计面板",bordered:"",column:T.value,"item-layout":"vertical",layout:"horizontal"},{default:n(()=>[(l(!0),v(ve,null,ge(V.value,(o,b)=>(l(),y(a,{key:b,label:o.name},{default:n(()=>[r(x(o.value),1)]),_:2},1032,["label"]))),128))]),_:1},8,["column"]),s(k,{title:"提示帮助",bordered:"",column:T.value,"item-layout":"vertical",layout:"horizontal"},{default:n(()=>[s(a,{label:"在服务器面板里创建计划任务"},{default:n(()=>[s(D,{size:"small",variant:"outline",theme:"primary",onClick:e[0]||(e[0]=()=>{z(I)("php webman unfreeze:money")})},{default:n(()=>[r("全自动解冻用户资金")]),_:1}),s(D,{size:"small",variant:"outline",theme:"primary",onClick:e[1]||(e[1]=()=>{z(I)("php webman auto:cash")})},{default:n(()=>[r("全自动创建结算信息")]),_:1}),s(D,{size:"small",variant:"outline",theme:"primary",onClick:e[2]||(e[2]=()=>{z(I)("php webman auto:daifu")})},{default:n(()=>[r("全自动结算打款命令")]),_:1})]),_:1})]),_:1},8,["column"])]),_:1})),[[_,["adminapi/merchant/cash/cashCount"]]])]),s(U),s(W,{title:"提现记录",bordered:!1},{default:n(()=>[S("div",Pe,[s(ae,{ref:"editRef",onSuccess:d},null,512)]),S("div",Re,[s($,{align:"baseline"},{default:n(()=>[s(h,{hover:"underline"},{default:n(()=>[r(" 打款站内信通知 已开启 ")]),_:1}),s(h,{theme:C.cash_emailnotify_open?"primary":"danger",onClick:e[3]||(e[3]=o=>Q("cash_emailnotify_open"))},{default:n(()=>[r(" 打款邮件通知 "+x(C.cash_emailnotify_open?"已开启":"已关闭"),1)]),_:1},8,["theme"])]),_:1}),S("div",Ne,[g((l(),y(D,{theme:"default",disabled:!m.value.length,onClick:O},{default:n(()=>[r(" 批量删除 ")]),_:1},8,["disabled"])),[[_,["adminapi/merchant/cash/delBatch"]]]),m.value.length?(l(),v("p",$e,"已选"+x(m.value.length)+"项",1)):P("",!0)])]),s(G,{ref:"tableRef","row-key":"id",data:R.value,columns:z(ne),"expand-on-row-click":!1,"expanded-row-keys":w.value,"expand-icon":!1,hover:R.value.length>0,"header-affixed-top":J.value,pagination:p.value,"lazy-load":"","max-height":"100%","selected-row-keys":m.value,onPageChange:j,onSelectChange:M},{expandedRow:n(({row:o})=>[r(x(o.collect_info),1)]),operate:n(({row:o})=>[o.status==0&&o.daifu_status==0?(l(),v("span",Ie,[s($,{size:"small"},{default:n(()=>[g((l(),y(h,{theme:"primary",onClick:b=>K(o.id)},{default:n(()=>[r("手工打款")]),_:2},1032,["onClick"])),[[_,["adminapi/merchant/cash/pass"]]]),g((l(),y(h,{theme:"primary",onClick:b=>E("autopass",o.id)},{default:n(()=>[r("代付打款")]),_:2},1032,["onClick"])),[[_,["adminapi/merchant/cash/autoPass"]]]),g((l(),y(h,{theme:"danger",onClick:b=>q(o.id)},{default:n(()=>[r("驳回")]),_:2},1032,["onClick"])),[[_,["adminapi/merchant/cash/refuse"]]])]),_:2},1024)])):P("",!0),o.status==0&&o.daifu_status==1?(l(),v("span",Te," 已申请代付，请耐心等候，代付单号为 "+x(o.orderid),1)):P("",!0),o.status==1?g((l(),v("span",Ve,[s(h,{theme:"danger",onClick:b=>H(o.id)},{default:n(()=>[r("删除")]),_:2},1032,["onClick"])])),[[_,["adminapi/merchant/cash/del"]]]):P("",!0)]),_:1},8,["data","columns","expanded-row-keys","hover","header-affixed-top","pagination","selected-row-keys"])]),_:1})])}}});const We=ee(Ae,[["__scopeId","data-v-2bd5759d"]]);export{We as default};
