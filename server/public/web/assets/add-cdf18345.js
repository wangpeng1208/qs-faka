import{d as I,a2 as R,r as n,w as F,o as M,U as B,l as T,V as D,W as l,M as t,u as d,_}from"./vue-51c2f431.js";import{l as L}from"./category-baa68958.js";import{a as N}from"./coupon-c6da87c9.js";import{M as v,b_ as G,_ as P}from"./index-ebc513dd.js";import{i as $,a as j}from"./constant-322a956b.js";import{I as A}from"./index-69f74367.js";import{B as E}from"./index-3b3d7414.js";import{S as H}from"./index-31ca20e2.js";import{F as O,a as W}from"./index-3f5d4a71.js";import{I as z}from"./index-8fdc26dc.js";import{R as J}from"./index-b07945fd.js";import{S as K}from"./index-b206f515.js";import{D as Q}from"./index-177e8cb4.js";import{T as X}from"./index-de8c6515.js";import{C as Y}from"./index-0945ca82.js";import"./libs-1cd01688.js";import"./plugins-ccea0c8f.js";import"./others-24e1b5c5.js";import"./echarts-a13411ed.js";import"./date-97dddb73.js";import"./dep-cc1906a8-b100bfdb.js";import"./dep-0742ae64-e2730b23.js";import"./fake-arrow-cad1ce15.js";import"./index-e2b6bb2b.js";import"./index-7eef5ecd.js";import"./index-15716071.js";import"./index-9aa638bc.js";import"./useLengthLimit-207427cf.js";import"./browse-ff8f6fe8.js";import"./close-circle-filled-9eb22673.js";import"./_baseSet-75352e55.js";import"./omit-7a5ea809.js";import"./index-f001b1b6.js";import"./dep-34b004f3-3e1a5725.js";import"./index-d5e568e3.js";import"./form-model-7023f79a.js";import"./isNil-c75b1b34.js";import"./dep-ef1abd17-ab5403a7.js";import"./add-06b22f1a.js";import"./index-b3f3b742.js";import"./index-cda4d585.js";import"./index-78761eb8.js";import"./chevron-right-0650800f.js";import"./ellipsis-f8b55775.js";const Z={name:"GoodsCouponAdd"},ee=I({...Z,setup(te){const c=R(),o=n({cate_id:"",type:1,amount:"",quantity:"",min_banlance:"",expire_at:"",remark:"",import_coupon:0}),p=n("满减优惠券，设置多少元则抵扣总价的多少元");F(()=>o.value.type,m=>{m===1?p.value=`
      满减优惠券，设置多少元则抵扣总价的多少元
      `:p.value=`
      折扣卡券，设置比例10%则是9折20%为8折，以此类推
      `});const u=n([]),b=async()=>{const{data:m}=await L();u.value=m.list,u.value.unshift({label:"店铺通用",value:""})},f=n(null),y={amount:[{required:!0,message:"请输入折扣面额",type:"error"}],quantity:[{required:!0,message:"请输入数量",type:"error"}],expire_at:[{required:!0,message:"请选择到期时间",type:"error"}]};M(()=>{b();const{query:m}=c.currentRoute.value;m.cate_id&&(o.value.cate_id=m.cate_id)});const V=async()=>{const m=await f.value.validate();if(typeof m!="object"&&m){const e=await N(o.value);e.code===1?(v.success("新增成功。可手动返回原页面"),o.value.import_coupon&&G(e.data.url)):v.error(e.msg)}};return(m,e)=>{const x=A,i=E,k=H,r=O,s=z,w=J,g=K,U=Q,q=X,C=B("wp-check-tag"),h=W,S=Y;return T(),D(S,{title:"添加优惠券",class:"basic-container",bordered:!1},{actions:l(()=>[t(i,{variant:"text",theme:"default",onClick:e[0]||(e[0]=a=>d(c).push("/merchant/goods/coupon"))},{icon:l(()=>[t(x,{name:"rollback"})]),default:l(()=>[e[9]||(e[9]=_(" 返回 ",-1))]),_:1})]),default:l(()=>[t(h,{ref_key:"form",ref:f,class:"base-form",data:o.value,rules:y,"label-align":"left","label-width":160,onSubmit:V},{default:l(()=>[t(r,{label:"选择分类",name:"cate_id",help:"【必选】请选择商品分类"},{default:l(()=>[t(k,{modelValue:o.value.cate_id,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.cate_id=a),placeholder:"请选择商品分类",type:"search",clearable:"",options:u.value,style:{width:"415px"}},null,8,["modelValue","options"])]),_:1}),t(r,{label:"折扣面额",name:"amount",help:p.value},{default:l(()=>[t(g,null,{default:l(()=>[t(s,{modelValue:o.value.amount,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.amount=a),"decimal-places":0,theme:"normal",placeholder:"请输入数字",style:{width:"415px"}},null,8,["modelValue"]),t(w,{modelValue:o.value.type,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.type=a),options:d($)},null,8,["modelValue","options"])]),_:1})]),_:1},8,["help"]),t(r,{label:"生成数量",name:"quantity",help:"最多一次生成200张"},{default:l(()=>[t(s,{modelValue:o.value.quantity,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.quantity=a),max:200,min:1,"decimal-places":0,theme:"normal"},null,8,["modelValue"])]),_:1}),t(r,{label:"最低使用金额",name:"min_banlance",help:"此功能为满减优惠卷"},{default:l(()=>[t(s,{modelValue:o.value.min_banlance,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.min_banlance=a),placeholder:"请输入数字","decimal-places":0,theme:"normal"},null,8,["modelValue"])]),_:1}),t(r,{label:"到期时间",name:"expire_at",help:"过期优惠券系统将自动清理"},{default:l(()=>[t(U,{modelValue:o.value.expire_at,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.expire_at=a),"enable-time-picker":"","allow-input":"",clearable:"",placeholder:"请选择到期时间"},null,8,["modelValue"])]),_:1}),t(r,{label:"备注信息",name:"remark"},{default:l(()=>[t(q,{modelValue:o.value.remark,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.remark=a),placeholder:"",style:{width:"415"}},null,8,["modelValue"])]),_:1}),t(r,{label:"导出格式",name:"import_coupon",help:"添加完导出优惠券"},{default:l(()=>[t(C,{modelValue:o.value.import_coupon,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.import_coupon=a),items:d(j)},null,8,["modelValue","items"])]),_:1}),t(r,null,{default:l(()=>[t(i,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:l(()=>[...e[10]||(e[10]=[_(" 提交 ",-1)])]),_:1}),t(i,{type:"reset",class:"form-submit-cancel",theme:"default",variant:"base"},{default:l(()=>[...e[11]||(e[11]=[_(" 重置 ",-1)])]),_:1})]),_:1})]),_:1},8,["data"])]),_:1})}}});const We=P(ee,[["__scopeId","data-v-894d93c6"]]);export{We as default};
