import{r as f,M as r}from"./index-6b6fbd51.js";import{l as W}from"./sms-3ce29a55.js";import{t as H}from"./table-48199bef.js";import{B as C}from"./index-c63cfed1.js";import{S as J}from"./index-0fc44882.js";import{L as Q}from"./index-95260792.js";import{T as X}from"./index-98194870.js";import{R as Y}from"./index-ae3a9dfb.js";import{F as Z,a as ee}from"./index-0fff1870.js";import{S as te}from"./index-18bbad02.js";import{I as oe}from"./index-757197b9.js";import{T as ae}from"./index-591150e2.js";import{D as le}from"./index-f937956d.js";import{C as se}from"./index-c2a11f34.js";import{d as ie,A as T,r as p,l as ne,V as me,W as l,M as t,u,_ as k}from"./vue-d500b9b9.js";import"./libs-d79b82a8.js";import"./plugins-f7b3b094.js";import"./others-381f73b9.js";import"./echarts-415f4206.js";import"./global-0d825ba6.js";import"./index-03ea1434.js";import"./index-424a7ec0.js";import"./omit-82a91481.js";import"./dep-581cd4f1-15e6aa5c.js";import"./index-5be2c846.js";import"./dep-34b004f3-3e1a5725.js";import"./index-d6e54721.js";import"./dep-cc1906a8-b100bfdb.js";import"./index-912dcce2.js";import"./dep-ef1abd17-afe34463.js";import"./add-291eb586.js";import"./index-9bccbd74.js";import"./chevron-right-6ae15ba3.js";import"./ellipsis-1db91eb9.js";import"./dep-0742ae64-0833915c.js";import"./plugin-cad85236.js";import"./dialog-8ec74ee0.js";import"./form-model-0fc8dc05.js";import"./_baseSet-c1826ef2.js";import"./dep-b10d5f92-c98df075.js";import"./isNil-c75b1b34.js";import"./index-e205a427.js";import"./close-circle-filled-3424a47b.js";import"./fake-arrow-d40b6f7e.js";import"./index-b8d4edf9.js";import"./useLengthLimit-14a00f39.js";import"./browse-35e2443f.js";function re(n){return f.post({url:"/adminapi/system/notification/list",params:n})}function de(n){return f.post({url:"/adminapi/system/notification/add",params:n})}function pe(n){return f.post({url:"/adminapi/system/notification/edit",params:n})}function ue(n){return f.post({url:"/adminapi/system/notification/del",params:n})}function fe(n){return f.post({url:"/adminapi/system/notification/setSmsConfig",params:n})}const ce={name:"SystemNotificationIndex"},mt=ie({...ce,setup(n){const I=[{title:"ID",colKey:"id",width:50},{title:"通知名称",colKey:"name"},{title:"通知标识",colKey:"mark"},{title:"短信通知",colKey:"is_sms",width:180,cell:(a,{row:e})=>{const V=a(C,{size:"small",theme:e.is_sms===1?"success":"danger"},()=>e.is_sms===1?"开启":"禁用"),g=a(C,{theme:"primary",size:"small",style:"margin-left: 10px",onClick:()=>{B(e)}},()=>"编辑配置");return[V,g]}},{title:"操作",colKey:"operate",width:100}],{pagination:O,fetchData:c,dataLoading:K,headerAffixedTop:L,rehandlePageChange:h,lists:j}=H({fetchFun:re});c();const s=T({}),_=p(!1),B=async a=>{Object.keys(s).forEach(e=>{delete s[e]}),F(),s.id=a.id,s.status=a.is_sms,_.value=!0,Object.assign(s,{...a.sms_config})},x=p([]),F=async()=>{x.value=(await W({})).data.list??[]},P=async()=>{const a=await fe({data:s});a.code===1?(r.success(a.msg),_.value=!1,c()):r.error(a.msg)},v=p("add"),y=p("新增配置"),i=T({}),d=p(!1),$=a=>{v.value="edit",y.value="编辑配置",d.value=!0,Object.assign(i,{...a})},z=()=>{v.value="add",y.value="新增配置",d.value=!0,Object.keys(i).forEach(a=>{delete i[a]})},A=async a=>{const e=await ue({id:a.id});e.code===1?(r.success(e.msg),c()):r.error(e.msg)},E=async()=>{const a=v.value==="add"?await de({data:i}):await pe({data:i});a.code===1?(r.success(a.msg),d.value=!1,c()):r.error(a.msg)};return(a,e)=>{const V=C,g=J,w=Q,M=X,D=Y,m=Z,N=te,b=oe,R=ae,U=ee,S=le,q=se;return ne(),me(q,{title:"通知场景",class:"basic-container",bordered:!1},{default:l(()=>[t(M,{size:"small",data:u(j),columns:I,"row-key":"id","vertical-align":"middle",loading:u(K),pagination:u(O),"header-affixed-top":u(L),"table-layout":"fixed","max-height":"100%",onPageChange:u(h)},{topContent:l(()=>[t(g,{style:{margin:"0 0 15px 0"}},{default:l(()=>[t(V,{theme:"primary",onClick:e[0]||(e[0]=o=>z())},{default:l(()=>[...e[11]||(e[11]=[k("新增",-1)])]),_:1})]),_:1})]),operate:l(({row:o})=>[t(g,null,{default:l(()=>[t(w,{theme:"primary",onClick:G=>$(o)},{default:l(()=>[...e[12]||(e[12]=[k("编辑",-1)])]),_:1},8,["onClick"]),t(w,{theme:"danger",onClick:G=>A(o)},{default:l(()=>[...e[13]||(e[13]=[k("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:1},8,["data","loading","pagination","header-affixed-top","onPageChange"]),t(S,{visible:_.value,"onUpdate:visible":e[5]||(e[5]=o=>_.value=o),header:"短信配置","on-confirm":P},{default:l(()=>[t(U,null,{default:l(()=>[t(m,{label:"状态"},{default:l(()=>[t(D,{modelValue:s.status,"onUpdate:modelValue":e[1]||(e[1]=o=>s.status=o),options:[{label:"开启",value:1},{label:"关闭",value:0}]},null,8,["modelValue"])]),_:1}),t(m,{label:"短信平台"},{default:l(()=>[t(N,{modelValue:s.sms_gateway,"onUpdate:modelValue":e[2]||(e[2]=o=>s.sms_gateway=o),clearable:"",placeholder:"请选择短信模板",options:x.value},null,8,["modelValue","options"])]),_:1}),t(m,{label:"模板ID"},{default:l(()=>[t(b,{modelValue:s.sms_template_id,"onUpdate:modelValue":e[3]||(e[3]=o=>s.sms_template_id=o),clearable:"",placeholder:"请输入短信模板ID"},null,8,["modelValue"])]),_:1}),t(m,{label:"短信内容",help:"复制短信内容到对应平台"},{default:l(()=>[t(R,{modelValue:s.sms_template_content,"onUpdate:modelValue":e[4]||(e[4]=o=>s.sms_template_content=o),clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["visible"]),t(S,{visible:d.value,"onUpdate:visible":e[10]||(e[10]=o=>d.value=o),header:y.value,"on-confirm":E},{default:l(()=>[t(U,null,{default:l(()=>[t(m,{label:"短信通知"},{default:l(()=>[t(D,{modelValue:i.is_sms,"onUpdate:modelValue":e[6]||(e[6]=o=>i.is_sms=o),options:[{label:"开启",value:1},{label:"关闭",value:0}]},null,8,["modelValue"])]),_:1}),t(m,{label:"通知名称"},{default:l(()=>[t(b,{modelValue:i.name,"onUpdate:modelValue":e[7]||(e[7]=o=>i.name=o),clearable:"",placeholder:"请输入通知场景名称"},null,8,["modelValue"])]),_:1}),t(m,{label:"通知说明"},{default:l(()=>[t(b,{modelValue:i.title,"onUpdate:modelValue":e[8]||(e[8]=o=>i.title=o),clearable:"",placeholder:"请输入通知场景说明"},null,8,["modelValue"])]),_:1}),t(m,{label:"通知标识"},{default:l(()=>[t(b,{modelValue:i.mark,"onUpdate:modelValue":e[9]||(e[9]=o=>i.mark=o),clearable:"",placeholder:"请输入通知标识"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["visible","header"])]),_:1})}}});export{mt as default};
