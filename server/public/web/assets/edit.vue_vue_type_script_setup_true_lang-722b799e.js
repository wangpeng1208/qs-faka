import{a as D,e as x,b as F}from"./role-aa79c301.js";import{M as c}from"./index-5ae314bf.js";import{I as M}from"./index-9b4540ef.js";import{F as R,a as U}from"./index-9de6e4fb.js";import{D as A}from"./index-bf58812f.js";import{d as I,A as h,r as u,l as B,V as C,W as m,M as s}from"./vue-d500b9b9.js";const E={name:"EditPopup"},T=I({...E,emits:["success"],setup(P,{expose:p,emit:_}){const i={name:"",remark:"",id:0},a=h({...i}),r=u(!1),d=u(),v=o=>{if(d.value=o?"编辑角色":"添加角色",o)b(o);else for(const e in i)a[e]=i[e];r.value=!0},b=async o=>{const{data:e}=await D({id:o});for(const t in a)e[t]!=null&&e[t]!==void 0&&(t==="role"?a[t]=e[t].map(n=>n.id):a[t]=e[t])};p({init:v});const f=u(),k={name:[{required:!0,message:"必填",type:"error"}]},y=_,g=async()=>{const o=await f.value.validate();if(typeof o!="object"&&o)try{const e=a.id>0?await x(a):await F(a);if(e.code!==1){c.error(e.msg);return}c.success("操作成功"),r.value=!1,y("success")}catch(e){c.error(e.msg)}};return(o,e)=>{const t=M,n=R,V=U,w=A;return B(),C(w,{visible:r.value,"onUpdate:visible":e[2]||(e[2]=l=>r.value=l),"close-on-overlay-click":!1,"destroy-on-close":!0,header:d.value,"on-confirm":g},{default:m(()=>[s(V,{ref_key:"formRef",ref:f,"label-align":"left",data:a,rules:k,"label-width":80},{default:m(()=>[s(n,{label:"角色名",name:"name"},{default:m(()=>[s(t,{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=l=>a.name=l),clearable:"",placeholder:"请输入角色名"},null,8,["modelValue"])]),_:1}),s(n,{label:"备注",name:"remark"},{default:m(()=>[s(t,{modelValue:a.remark,"onUpdate:modelValue":e[1]||(e[1]=l=>a.remark=l),clearable:"",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])}}});export{T as _};
