import{c as T,r as x}from"./role-6f690db5.js";import{t as A}from"./table-d7bc18a8.js";import{I as O}from"./index-012f82c2.js";import{S as R}from"./index-757c1662.js";import{b as E,i as k,d as C,e as K,k as S,f as I,M as u}from"./index-1ae915eb.js";import{A as N}from"./index-044da480.js";import{T as V}from"./index-9e154440.js";import{D as L}from"./index-6889856c.js";import{d as M,A as j,r as B,l as U,V as q,W as m,M as g,_ as z,u as n}from"./vue-d500b9b9.js";var F=Object.prototype,W=F.hasOwnProperty,$=E(function(l,t){if(k(t)||C(t)){K(t,S(t),l);return}for(var o in t)W.call(t,o)&&I(l,o,t[o])});const G=$,se=M({__name:"rate",setup(l,{expose:t}){const o=[{label:"角色费率",value:1},{label:"通道费率",value:0}],a=j({channel_id:0,rate:0,status:0,role_id:0}),{pagination:h,fetchData:_,dataLoading:v,headerAffixedTop:w,rehandlePageChange:b,lists:c,searchData:y}=A({fetchFun:x,params:a}),D=[{colKey:"id",title:"ID"},{colKey:"title",title:"通道名称"},{colKey:"show_name",title:"显示名称"},{colKey:"rate",title:"费率",edit:{component:O,props:{autofocus:!0,placeholder:"请输入费率",tips:"单位：千分率",suffix:"‰",theme:"normal",min:0},validateTrigger:"change",abortEditOnEvent:["onEnter"],onEdited:e=>{a.rate=e.newRowData.rate,a.channel_id=e.newRowData.id,a.status=e.newRowData.status,f()},rules:[{required:!0,message:"不能为空"}],defaultEditable:!1}},{colKey:"status",title:"模式",cell:(e,{row:s})=>{var r;return(r=o.find(p=>p.value===s.status))==null?void 0:r.label},edit:{component:R,props:{options:o},onEdited:e=>{a.rate=e.newRowData.rate,a.channel_id=e.newRowData.id,a.status=e.newRowData.status,f()}}}],f=async()=>{const e=await T({...a});e.code===1?(u.success(e.msg),_()):u.error(e.msg)},d=B(!1);return t({init:e=>{G(a,{id:e,role_id:e}),console.log(a),y(),d.value=!0}}),(e,s)=>{const r=N,p=V,P=L;return U(),q(P,{visible:d.value,"onUpdate:visible":s[0]||(s[0]=i=>d.value=i),"close-on-overlay-click":!1,"destroy-on-close":!0,footer:!1,header:"角色费率",width:"900px"},{default:m(()=>{var i;return[g(r,null,{default:m(()=>[...s[1]||(s[1]=[z("优先级：用户费率》角色费率》通道费率。此处可将通道费率自定义提升到角色费率",-1)])]),_:1}),g(p,{"row-key":"id",data:n(c),columns:D,hover:((i=n(c))==null?void 0:i.length)>0,"header-affixed-top":n(w),pagination:n(h),"lazy-load":"","table-layout":"auto","max-height":"100%",loading:n(v),onPageChange:n(b)},null,8,["data","hover","header-affixed-top","pagination","loading","onPageChange"])]}),_:1},8,["visible"])}}});export{se as _};
