import{d as P,bH as T,bI as q,bJ as H,M,bK as W}from"./index-ebc513dd.js";import{b as j,d as E,r as c,A as G,l as r,V as p,W as a,a0 as J,a3 as $,M as o,u as f,_ as z,a4 as d}from"./vue-51c2f431.js";import Q from"./icon-f7890c47.js";import{I as X}from"./manifest-43e17205.js";import{R as Y}from"./index-b07945fd.js";import{F as Z,a as ee}from"./index-3f5d4a71.js";import{T as te,A as le}from"./index-7bf61179.js";import{I as oe}from"./index-15716071.js";import{B as ae}from"./index-3b3d7414.js";import{I as ne}from"./index-8fdc26dc.js";import{D as se}from"./index-c22455b5.js";const Ue=[{colKey:"title",title:"标题"},{colKey:"icon",title:"图标"},{colKey:"path",title:"路由地址"},{colKey:"perms",title:"权限字符"},{colKey:"orderNo",title:"排序"},{colKey:"hidden",title:"隐藏"},{colKey:"type",title:"类型"},{colKey:"operate",title:"操作"}],ie=[{label:"显示",value:0},{label:"隐藏",value:1}],re=[{label:"目录",value:"L"},{label:"菜单",value:"M"},{label:"按钮",value:"B"}],pe=[{label:"缓存",value:1},{label:"不缓存",value:0}],me=j(()=>P().filter(m=>m.startsWith("admin/")).filter(m=>!m.includes("/components/")).map(m=>({label:m,value:m}))),de={class:"dialog-title"},ue="https://tdesign.gtimg.com/icon/0.4.0/fonts/index.css",Ie=E({__name:"edit",emits:["success"],setup(U,{expose:V,emit:m}){const I=m,v=c(),S=()=>{v.value.init(e.icon)},w=n=>{e.icon=n},b={id:0,pid:0,app:"admin",title:"",path:"",icon:"",component:"",type:"M",orderNo:0,hidden:0,redirect:"",perms:"",keep_alive:0},e=G({...b}),g=c([]),x=async()=>{const{data:n}=await W({app:"admin"});g.value=n.list},h=c(null),y=c(!1),_=c("添加菜单"),K=(n,t)=>{if(n)_.value="编辑菜单",N(n);else{_.value="添加菜单";for(const s in b)e[s]=b[s];t&&(e.pid=t)}y.value=!0,x()},N=async n=>{const{data:t}=await T({id:n});for(const s in e)t[s]!=null&&t[s]!==void 0&&(e[s]=t[s])};V({init:K});const C=n=>{e.component=n===0?"Layout":""},B={name:[{required:!0,message:"必填",type:"error"}],title:[{required:!0,message:"必填",type:"error"}]},k=async()=>{const n=await h.value.validate();if(typeof n!="object"&&n){let t;e.id===0?t=await q(e):t=await H(e),t.code===1?(M.success(t.msg),y.value=!1,I("success")):M.error(t.msg)}};return(n,t)=>{const s=Y,i=Z,D=te,u=oe,L=ae,R=le,A=ne,O=ee,F=se;return r(),p(F,{visible:y.value,"onUpdate:visible":t[11]||(t[11]=l=>y.value=l),"close-on-overlay-click":!1,"destroy-on-close":!0,width:"500","on-confirm":k,"confirm-on-enter":""},{header:a(()=>[J("div",de,$(_.value),1)]),default:a(()=>[o(O,{ref_key:"formRef",ref:h,"label-align":"left",data:e,rules:B,"label-width":80,onSubmit:k},{default:a(()=>[o(i,{label:"菜单类型",name:"type"},{default:a(()=>[o(s,{modelValue:e.type,"onUpdate:modelValue":t[0]||(t[0]=l=>e.type=l),options:f(re)},null,8,["modelValue","options"])]),_:1}),o(i,{label:"父级菜单",name:"pid"},{default:a(()=>[o(D,{modelValue:e.pid,"onUpdate:modelValue":t[1]||(t[1]=l=>e.pid=l),placeholder:"请选择父级菜单",data:g.value,clearable:"",filterable:"",onChange:C},null,8,["modelValue","data"])]),_:1}),o(i,{label:"菜单名称",name:"title"},{default:a(()=>[o(u,{modelValue:e.title,"onUpdate:modelValue":t[2]||(t[2]=l=>e.title=l),clearable:"",placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),o(Q,{ref_key:"iconSearchRef",ref:v,onSuccess:w},null,512),e.type==="L"||e.type==="M"?(r(),p(i,{key:0,label:"菜单图标",name:"icon"},{default:a(()=>[o(u,{modelValue:e.icon,"onUpdate:modelValue":t[3]||(t[3]=l=>e.icon=l),clearable:"",placeholder:"请选择菜单图标"},{"prefix-icon":a(()=>[o(f(X),{name:`t-icon t-icon-${e.icon}`,url:ue,style:{"margin-right":"8px"}},null,8,["name"])]),_:1},8,["modelValue"]),o(L,{theme:"primary",onClick:S},{default:a(()=>[...t[12]||(t[12]=[z("选择图标",-1)])]),_:1})]),_:1})):d("",!0),e.type==="L"||e.type==="M"?(r(),p(i,{key:1,label:"路由路径",name:"path",help:"访问的路由地址，如：`user`"},{default:a(()=>[o(u,{modelValue:e.path,"onUpdate:modelValue":t[4]||(t[4]=l=>e.path=l),clearable:"",placeholder:"请输入路由路径"},null,8,["modelValue"])]),_:1})):d("",!0),e.type==="M"?(r(),p(i,{key:2,label:"组件路径",name:"component",help:"组件路径，如：`user/setting/index`，默认在`pages`目录下",tips:"此处支持下拉和模糊搜索；外链使用Iframe,跳转路径为外链地址"},{default:a(()=>[o(R,{modelValue:e.component,"onUpdate:modelValue":t[5]||(t[5]=l=>e.component=l),options:f(me),clearable:"","highlight-keyword":"",filterable:"",placeholder:"请输入组件地址组件"},null,8,["modelValue","options"])]),_:1})):d("",!0),e.type==="M"||e.type==="B"?(r(),p(i,{key:3,label:"权限字符",name:"perms",help:"将作为server端API验权使用，跟该方法路径一致",tips:"应用+api+路径,例如：adminapi/setting/socialite/list"},{default:a(()=>[o(u,{modelValue:e.perms,"onUpdate:modelValue":t[6]||(t[6]=l=>e.perms=l),clearable:"",placeholder:"请输入权限字符"},null,8,["modelValue"])]),_:1})):d("",!0),e.type!="B"?(r(),p(i,{key:4,label:"菜单排序",name:"sort",help:"数值越小越排前"},{default:a(()=>[o(A,{modelValue:e.orderNo,"onUpdate:modelValue":t[7]||(t[7]=l=>e.orderNo=l),clearable:"",placeholder:"请输入排序",style:{width:"500px"},theme:"column",min:0},null,8,["modelValue"])]),_:1})):d("",!0),e.type==="L"||e.type==="M"?(r(),p(i,{key:5,label:"是否缓存",name:"cache",help:"开启缓存后，页面切换时不会重新加载"},{default:a(()=>[o(s,{modelValue:e.keep_alive,"onUpdate:modelValue":t[8]||(t[8]=l=>e.keep_alive=l),options:f(pe)},null,8,["modelValue","options"])]),_:1})):d("",!0),e.type==="L"||e.type==="M"?(r(),p(i,{key:6,label:"是否隐藏",name:"hidden",help:"选择隐藏则路由将不会出现在侧边栏，但仍然可以访问"},{default:a(()=>[o(s,{modelValue:e.hidden,"onUpdate:modelValue":t[9]||(t[9]=l=>e.hidden=l),options:f(ie)},null,8,["modelValue","options"])]),_:1})):d("",!0),e.type==="L"||e.type==="M"?(r(),p(i,{key:7,label:"跳转路径",name:"redirect",help:"分割菜单的时候用到"},{default:a(()=>[o(u,{modelValue:e.redirect,"onUpdate:modelValue":t[10]||(t[10]=l=>e.redirect=l),clearable:"",placeholder:"顶级栏目需要输入跳转路径"},null,8,["modelValue"])]),_:1})):d("",!0)]),_:1},8,["data"])]),_:1},8,["visible"])}}});export{Ie as _,Ue as c};
