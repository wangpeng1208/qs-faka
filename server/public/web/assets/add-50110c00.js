import{d as I,a2 as R,r as n,w as F,o as M,U as B,l as T,V as D,W as l,M as t,u as d,_}from"./vue-d500b9b9.js";import{l as L}from"./category-0a39d79d.js";import{a as N}from"./coupon-b28c39d7.js";import{M as v,bO as G,_ as O}from"./index-6b6fbd51.js";import{i as P,a as $}from"./constant-564e8a5c.js";import{I as j}from"./index-ea2a85c9.js";import{B as A}from"./index-c63cfed1.js";import{S as E}from"./index-18bbad02.js";import{F as H,a as W}from"./index-0fff1870.js";import{I as z}from"./index-912dcce2.js";import{R as J}from"./index-ae3a9dfb.js";import{S as K}from"./index-0fc44882.js";import{D as Q}from"./index-9ab1bb47.js";import{T as X}from"./index-591150e2.js";import{C as Y}from"./index-c2a11f34.js";import"./libs-d79b82a8.js";import"./plugins-f7b3b094.js";import"./others-381f73b9.js";import"./echarts-415f4206.js";import"./date-69e2f1fa.js";import"./dep-cc1906a8-b100bfdb.js";import"./dep-0742ae64-0833915c.js";import"./fake-arrow-d40b6f7e.js";import"./index-424a7ec0.js";import"./index-757197b9.js";import"./index-e205a427.js";import"./useLengthLimit-14a00f39.js";import"./browse-35e2443f.js";import"./close-circle-filled-3424a47b.js";import"./_baseSet-c1826ef2.js";import"./omit-82a91481.js";import"./index-b8d4edf9.js";import"./dep-34b004f3-3e1a5725.js";import"./index-5be2c846.js";import"./form-model-0fc8dc05.js";import"./isNil-c75b1b34.js";import"./dep-ef1abd17-afe34463.js";import"./add-291eb586.js";import"./index-d6e54721.js";import"./index-9bccbd74.js";import"./index-03ea1434.js";import"./chevron-right-6ae15ba3.js";import"./ellipsis-1db91eb9.js";const Z={name:"GoodsCouponAdd"},ee=I({...Z,setup(te){const c=R(),o=n({cate_id:"",type:1,amount:"",quantity:"",min_banlance:"",expire_at:"",remark:"",import_coupon:0}),p=n("满减优惠券，设置多少元则抵扣总价的多少元");F(()=>o.value.type,m=>{m===1?p.value=`
      满减优惠券，设置多少元则抵扣总价的多少元
      `:p.value=`
      折扣卡券，设置比例10%则是9折20%为8折，以此类推
      `});const u=n([]),b=async()=>{const{data:m}=await L();u.value=m.list,u.value.unshift({label:"店铺通用",value:""})},f=n(null),y={amount:[{required:!0,message:"请输入折扣面额",type:"error"}],quantity:[{required:!0,message:"请输入数量",type:"error"}],expire_at:[{required:!0,message:"请选择到期时间",type:"error"}]};M(()=>{b();const{query:m}=c.currentRoute.value;m.cate_id&&(o.value.cate_id=m.cate_id)});const V=async()=>{const m=await f.value.validate();if(typeof m!="object"&&m){const e=await N(o.value);e.code===1?(v.success("新增成功。可手动返回原页面"),o.value.import_coupon&&G(e.data.url)):v.error(e.msg)}};return(m,e)=>{const x=j,i=A,k=E,r=H,s=z,w=J,g=K,U=Q,q=X,C=B("wp-check-tag"),h=W,S=Y;return T(),D(S,{title:"添加优惠券",class:"basic-container",bordered:!1},{actions:l(()=>[t(i,{variant:"text",theme:"default",onClick:e[0]||(e[0]=a=>d(c).push("/merchant/goods/coupon"))},{icon:l(()=>[t(x,{name:"rollback"})]),default:l(()=>[e[9]||(e[9]=_(" 返回 ",-1))]),_:1})]),default:l(()=>[t(h,{ref_key:"form",ref:f,class:"base-form",data:o.value,rules:y,"label-align":"left","label-width":160,onSubmit:V},{default:l(()=>[t(r,{label:"选择分类",name:"cate_id",help:"【必选】请选择商品分类"},{default:l(()=>[t(k,{modelValue:o.value.cate_id,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.cate_id=a),placeholder:"请选择商品分类",type:"search",clearable:"",options:u.value,style:{width:"415px"}},null,8,["modelValue","options"])]),_:1}),t(r,{label:"折扣面额",name:"amount",help:p.value},{default:l(()=>[t(g,null,{default:l(()=>[t(s,{modelValue:o.value.amount,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.amount=a),"decimal-places":0,theme:"normal",placeholder:"请输入数字",style:{width:"415px"}},null,8,["modelValue"]),t(w,{modelValue:o.value.type,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.type=a),options:d(P)},null,8,["modelValue","options"])]),_:1})]),_:1},8,["help"]),t(r,{label:"生成数量",name:"quantity",help:"最多一次生成200张"},{default:l(()=>[t(s,{modelValue:o.value.quantity,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.quantity=a),max:200,min:1,"decimal-places":0,theme:"normal"},null,8,["modelValue"])]),_:1}),t(r,{label:"最低使用金额",name:"min_banlance",help:"此功能为满减优惠卷"},{default:l(()=>[t(s,{modelValue:o.value.min_banlance,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.min_banlance=a),placeholder:"请输入数字","decimal-places":0,theme:"normal"},null,8,["modelValue"])]),_:1}),t(r,{label:"到期时间",name:"expire_at",help:"过期优惠券系统将自动清理"},{default:l(()=>[t(U,{modelValue:o.value.expire_at,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.expire_at=a),"enable-time-picker":"","allow-input":"",clearable:"",placeholder:"请选择到期时间"},null,8,["modelValue"])]),_:1}),t(r,{label:"备注信息",name:"remark"},{default:l(()=>[t(q,{modelValue:o.value.remark,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.remark=a),placeholder:"",style:{width:"415"}},null,8,["modelValue"])]),_:1}),t(r,{label:"导出格式",name:"import_coupon",help:"添加完导出优惠券"},{default:l(()=>[t(C,{modelValue:o.value.import_coupon,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.import_coupon=a),items:d($)},null,8,["modelValue","items"])]),_:1}),t(r,null,{default:l(()=>[t(i,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:l(()=>[...e[10]||(e[10]=[_(" 提交 ",-1)])]),_:1}),t(i,{type:"reset",class:"form-submit-cancel",theme:"default",variant:"base"},{default:l(()=>[...e[11]||(e[11]=[_(" 重置 ",-1)])]),_:1})]),_:1})]),_:1},8,["data"])]),_:1})}}});const He=O(ee,[["__scopeId","data-v-894d93c6"]]);export{He as default};
