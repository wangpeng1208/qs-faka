import{d as j,a2 as E,A as H,r as C,o as J,l as p,V as u,W as e,M as a,u as i,_ as n,a0 as c,a3 as $,a4 as g,n as K}from"./vue-d500b9b9.js";import{l as Q}from"./category-0a39d79d.js";import{s as X,l as Y}from"./good-d4ddceee.js";import{R as Z}from"./index-bef910b5.js";import{t as tt}from"./table-48199bef.js";import{u as et}from"./useBatchAction-590dba1a.js";import{f as ot}from"./date-69e2f1fa.js";import at from"./GoodsLink-f2e7bdc3.js";import{c as it}from"./constant-e2d6cce9.js";import{M as V,L as nt}from"./index-6b6fbd51.js";import{I as rt}from"./index-ea2a85c9.js";import{B as st}from"./index-c63cfed1.js";import{S as lt}from"./index-18bbad02.js";import{I as mt}from"./index-757197b9.js";import{S as dt}from"./index-0fc44882.js";import{T as pt}from"./index-b8d4edf9.js";import{S as ut}from"./index-87495c29.js";import{L as ct}from"./index-95260792.js";import{B as ft}from"./index-98194870.js";import{C as _t}from"./index-c2a11f34.js";import"./no-list-e2f85d5e.js";import"./global-0d825ba6.js";import"./base-9eb484ec.js";import"./plugin-cad85236.js";import"./dialog-8ec74ee0.js";import"./dep-cc1906a8-b100bfdb.js";import"./dep-581cd4f1-15e6aa5c.js";import"./omit-82a91481.js";import"./libs-d79b82a8.js";import"./link-b8711a35.js";import"./link-697752dc.js";import"./index-ae3a9dfb.js";import"./dep-0742ae64-0833915c.js";import"./dep-34b004f3-3e1a5725.js";import"./isNil-c75b1b34.js";import"./index-f937956d.js";import"./plugins-f7b3b094.js";import"./others-381f73b9.js";import"./echarts-415f4206.js";import"./fake-arrow-d40b6f7e.js";import"./index-424a7ec0.js";import"./_baseSet-c1826ef2.js";import"./close-circle-filled-3424a47b.js";import"./index-5be2c846.js";import"./index-e205a427.js";import"./useLengthLimit-14a00f39.js";import"./browse-35e2443f.js";import"./index-03ea1434.js";import"./index-d6e54721.js";import"./index-912dcce2.js";import"./dep-ef1abd17-afe34463.js";import"./add-291eb586.js";import"./index-9bccbd74.js";import"./chevron-right-6ae15ba3.js";import"./ellipsis-1db91eb9.js";import"./form-model-0fc8dc05.js";import"./dep-b10d5f92-c98df075.js";const gt={class:"category-header c-flex"},ht={class:"l"},vt={class:"r c-flex"},yt={name:"Goods"},Le=j({...yt,setup(kt){const d=E(),l=H({cate_id:null,name:""}),{query:x}=d.currentRoute.value;x.cate_id&&(l.cate_id=+x.cate_id);const{pagination:B,fetchData:h,dataLoading:R,headerAffixedTop:T,rehandlePageChange:z,lists:L,searchData:M}=tt({fetchFun:Y,params:l}),N=C(!1),b=C([]),U=async()=>{const{data:r}=await Q();b.value=r.list};J(()=>{h(),U()});const S=C(),G=async r=>{var t;await K(),(t=S.value)==null||t.init(r.id)},I=async r=>{et({title:"提醒",body:`是否确认删除(${r.name})？`,ids:r.id,url:"/merchantapi/goods/good/del",fetchList:()=>{h()}})},P=async(r,t)=>{try{const s=await X({id:r,val:t});s.code===1?V.success(s.msg):V.error(s.msg)}catch{V.error("修改失败")}},A=r=>{const{id:t}=r;d.push(`/merchant/goods/edit?id=${t}`)};return(r,t)=>{const s=rt,v=st,D=lt,q=mt,y=dt,f=pt,w=ut,_=ct,F=ft,O=nt,W=_t;return p(),u(W,{title:"商品列表",class:"basic-container",bordered:!1},{actions:e(()=>[a(v,{variant:"text",theme:"default",onClick:t[0]||(t[0]=k=>i(d).push("/merchant/goods/trash"))},{icon:e(()=>[a(s,{name:"delete"})]),default:e(()=>[t[4]||(t[4]=n(" 回收站 ",-1))]),_:1})]),default:e(()=>{var k;return[c("div",gt,[c("div",ht,[a(v,{theme:"primary",onClick:t[1]||(t[1]=o=>i(d).push("/merchant/goods/add"))},{default:e(()=>[...t[5]||(t[5]=[n(" 添加 ",-1)])]),_:1})]),c("div",vt,[a(y,null,{default:e(()=>[a(D,{modelValue:l.cate_id,"onUpdate:modelValue":t[2]||(t[2]=o=>l.cate_id=o),clear:i(h),empty:"没有分类",placeholder:"全部分类",type:"search",clearable:"",options:b.value},null,8,["modelValue","clear","options"]),a(q,{modelValue:l.name,"onUpdate:modelValue":t[3]||(t[3]=o=>l.name=o),placeholder:"请输入商品名",clearable:""},{"suffix-icon":e(()=>[a(s,{name:"search"})]),_:1},8,["modelValue"]),a(v,{theme:"primary",onClick:i(M)},{default:e(()=>[...t[6]||(t[6]=[n("查询",-1)])]),_:1},8,["onClick"])]),_:1})])]),a(F,{data:i(L),columns:i(it),"row-key":"id","vertical-align":"middle",hover:((k=i(L))==null?void 0:k.length)>0,pagination:i(B),loading:i(R),"header-affixed-top":i(T),"table-layout":"auto","max-height":"100%",onPageChange:i(z)},{name:e(({row:o})=>[a(y,{direction:"vertical",size:"small",class:"tag-demo light"},{default:e(()=>[c("span",null,[n($(o.name)+" ",1),o.wholesale_discount==1?(p(),u(f,{key:0,title:"支持批发优惠",theme:"success",variant:"light",size:"small",shape:"round"},{default:e(()=>[...t[7]||(t[7]=[n("惠",-1)])]),_:1})):g("",!0),o.coupon_type==1?(p(),u(f,{key:1,title:"支持优惠券",theme:"primary",variant:"light",size:"small",shape:"round"},{default:e(()=>[...t[8]||(t[8]=[n("券",-1)])]),_:1})):g("",!0),o.take_card_type!=0?(p(),u(f,{key:2,title:"提卡必填或选填取卡密码",theme:"warning",variant:"light",size:"small",shape:"round"},{default:e(()=>[...t[9]||(t[9]=[n("取",-1)])]),_:1})):g("",!0),o.visit_type==1?(p(),u(f,{key:3,title:"商品购买页面需要访问密码",theme:"danger",variant:"light",size:"small",shape:"round"},{default:e(()=>[...t[10]||(t[10]=[n("密",-1)])]),_:1})):g("",!0)])]),_:2},1024)]),status:e(({row:o})=>[a(w,{modelValue:o.status,"onUpdate:modelValue":m=>o.status=m,"custom-value":[1,0],onClick:m=>P(o.id,o.status)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),create_at:e(({row:o})=>[c("span",null,$(i(ot)(o.create_at)),1)]),operation:e(({row:o})=>[a(y,null,{default:e(()=>[a(_,{theme:"primary",hover:"color",onClick:m=>G(o)},{default:e(()=>[...t[11]||(t[11]=[n("链接",-1)])]),_:1},8,["onClick"]),a(_,{theme:"primary",hover:"color",onClick:m=>i(d).push(`/merchant/goods/card/add?goods_id=${o.id}`)},{default:e(()=>[...t[12]||(t[12]=[n("加库存",-1)])]),_:1},8,["onClick"]),a(_,{theme:"primary",hover:"color",onClick:m=>A(o)},{default:e(()=>[...t[13]||(t[13]=[n("编辑",-1)])]),_:1},8,["onClick"]),a(_,{theme:"danger",hover:"color",onClick:m=>I(o)},{default:e(()=>[...t[14]||(t[14]=[n("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),empty:e(()=>[a(Z,{title:"",tip:"暂无相关数据",type:"list"})]),_:1},8,["data","columns","hover","pagination","loading","header-affixed-top","onPageChange"]),a(O,{loading:N.value,size:"small",fullscreen:""},null,8,["loading"]),a(at,{ref_key:"goodLinkRef",ref:S},null,512)]}),_:1})}}});export{Le as default};
