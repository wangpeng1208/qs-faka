import{g as ee,e as te}from"./config-716c863e.js";import{r as x,c as z,M as d,_ as ae}from"./index-6b6fbd51.js";import{t as oe}from"./table-48199bef.js";import{u as A}from"./useBatchAction-590dba1a.js";import{_ as ne,c as se}from"./search.vue_vue_type_script_setup_true_lang-e916a8d2.js";import{D as O}from"./plugin-cad85236.js";import{I as ie}from"./index-757197b9.js";import{D as re,a as le}from"./index-d44b8ee5.js";import{B as me}from"./index-c63cfed1.js";import{S as ce}from"./index-0fc44882.js";import{L as de}from"./index-95260792.js";import{T as pe}from"./index-98194870.js";import{C as ue}from"./index-c2a11f34.js";import{d as fe,A as j,r as k,$ as he,l as r,m as b,a0 as N,a1 as _,V as g,W as a,M as n,G as _e,a5 as ge,_ as s,a3 as D,u as l,a4 as R,j as ye}from"./vue-d500b9b9.js";import"./libs-d79b82a8.js";import"./plugins-f7b3b094.js";import"./others-381f73b9.js";import"./echarts-415f4206.js";import"./global-0d825ba6.js";import"./base-9eb484ec.js";import"./date-69e2f1fa.js";import"./index-b8d4edf9.js";import"./dep-34b004f3-3e1a5725.js";import"./search-a8b831db.js";import"./index-2132cfb3.js";import"./index-0fff1870.js";import"./dep-0742ae64-0833915c.js";import"./index-e205a427.js";import"./form-model-0fc8dc05.js";import"./_baseSet-c1826ef2.js";import"./isNil-c75b1b34.js";import"./close-circle-filled-3424a47b.js";import"./index-18bbad02.js";import"./dep-cc1906a8-b100bfdb.js";import"./fake-arrow-d40b6f7e.js";import"./index-424a7ec0.js";import"./omit-82a91481.js";import"./index-5be2c846.js";import"./index-9ab1bb47.js";import"./index-d6e54721.js";import"./index-912dcce2.js";import"./dep-ef1abd17-afe34463.js";import"./add-291eb586.js";import"./index-9bccbd74.js";import"./index-03ea1434.js";import"./chevron-right-6ae15ba3.js";import"./ellipsis-1db91eb9.js";import"./dialog-8ec74ee0.js";import"./dep-581cd4f1-15e6aa5c.js";import"./useLengthLimit-14a00f39.js";import"./browse-35e2443f.js";import"./index-ae3a9dfb.js";import"./dep-b10d5f92-c98df075.js";function ve(m){return x.post({url:"/adminapi/merchant/cash/list",params:m})}function Ce(){return x.post({url:"/adminapi/merchant/cash/cashCount"})}function ke(m){return x.post({url:"/adminapi/merchant/cash/del",params:m})}function be(m){return x.post({url:"/adminapi/merchant/cash/refuse",params:m})}function xe(m){return x.post({url:"/adminapi/merchant/cash/autoPass",params:m})}const we={class:"basic-container"},De={style:{padding:"15px"}},Be={class:"category-header c-flex"},Pe={class:"l"},Se={key:0,class:"selected-count"},ze={key:0},Ne={key:1},Re=fe({__name:"index",setup(m){const $=j({}),{pagination:M,fetchData:c,dataLoading:F,headerAffixedTop:J,rehandlePageChange:K,lists:L}=oe({fetchFun:ve,params:$});c();const q=t=>{Object.assign($,t),c()},p=k([]),E=t=>{p.value=t},G=()=>A({title:"提醒",body:"是否确认删除？",ids:p.value,url:"/adminapi/merchant/cash/delBatch",fetchList:()=>{c(),p.value=[]}}),I=k(5),T=k([]);(async()=>{const{data:t}=await Ce();T.value=t})(),c();const y=k([""]),W=async t=>{y.value.includes(t)?y.value=[]:y.value=[t],A({title:"提醒",body:"是否确认打款",ids:t,url:"/adminapi/merchant/cash/pass",fetchList:()=>{c(),y.value=[]}})},B=k(""),H=async t=>{const e=O.confirm({header:"请输入驳回原因",body:()=>ye(ie,{onInput:o=>{B.value=o.target.value},placeholder:"请输入驳回原因"}),confirmBtn:{content:"提交",theme:"primary",loading:!1},onConfirm:()=>{e.update({confirmBtn:{content:"提交中",loading:!0}}),be({id:t,reason:B.value}).then(o=>{o.code===1?(d.success(o.msg),B.value="",e.hide(),c()):d.error(o.msg)})}})},Q=async(t,e)=>{const o=O.confirm({header:"是否确认全自动打款",body:"是否确认提交？",confirmBtn:{content:"提交",theme:"primary",loading:!1},theme:"warning",onConfirm:()=>{o.update({confirmBtn:{content:"提交中",loading:!0}}),xe({id:e,type:t}).then(u=>{u.code===1?(d.success(u.msg),o.hide(),c()):d.error(u.msg)})}})},U=async t=>{const e=await ke({id:t});e.code===1?(d.success(e.msg),c()):d.error(e.msg)},v=j({cash_weixinnotify_open:0,cash_emailnotify_open:0}),V=async()=>{const{data:t}=await ee({field:Object.keys(v)});for(const e in t)v[e]=t[e]};V();const X=async t=>{const e=JSON.parse(JSON.stringify(v));e[t]=e[t]===1?0:1;const o=await te({data:{...e}});o.code===1?(d.success(o.msg),V()):d.error(o.msg)};return(t,e)=>{const o=re,u=le,w=me,P=ce,f=de,Y=pe,Z=ue,h=he("perms");return r(),b("div",we,[N("div",De,[_((r(),g(P,null,{default:a(()=>[n(u,{title:"统计面板",bordered:"",column:I.value,"item-layout":"vertical",layout:"horizontal"},{default:a(()=>[(r(!0),b(_e,null,ge(T.value,(C,i)=>(r(),g(o,{key:i,label:C.name},{default:a(()=>[s(D(C.value),1)]),_:2},1032,["label"]))),128))]),_:1},8,["column"]),n(u,{title:"提示帮助",bordered:"",column:I.value,"item-layout":"vertical",layout:"horizontal"},{default:a(()=>[n(o,{label:"在服务器面板里创建计划任务"},{default:a(()=>[n(w,{size:"small",variant:"outline",theme:"primary",onClick:e[0]||(e[0]=()=>{l(z)("php webman unfreeze:money")})},{default:a(()=>[...e[4]||(e[4]=[s("全自动解冻用户资金",-1)])]),_:1}),n(w,{size:"small",variant:"outline",theme:"primary",onClick:e[1]||(e[1]=()=>{l(z)("php webman auto:cash")})},{default:a(()=>[...e[5]||(e[5]=[s("全自动创建结算信息",-1)])]),_:1}),n(w,{size:"small",variant:"outline",theme:"primary",onClick:e[2]||(e[2]=()=>{l(z)("php webman auto:daifu")})},{default:a(()=>[...e[6]||(e[6]=[s("全自动结算打款命令",-1)])]),_:1})]),_:1})]),_:1},8,["column"])]),_:1})),[[h,["adminapi/merchant/cash/cashCount"]]])]),n(Z,{title:"",bordered:!1},{default:a(()=>{var C;return[n(ne,{onSuccess:q}),N("div",Be,[n(P,{align:"baseline"},{default:a(()=>[n(f,{hover:"underline"},{default:a(()=>[...e[7]||(e[7]=[s(" 打款站内信通知 已开启 ",-1)])]),_:1}),n(f,{theme:v.cash_emailnotify_open?"primary":"danger",onClick:e[3]||(e[3]=i=>X("cash_emailnotify_open"))},{default:a(()=>[s(" 打款邮件通知 "+D(v.cash_emailnotify_open?"已开启":"已关闭"),1)]),_:1},8,["theme"])]),_:1}),N("div",Pe,[_((r(),g(w,{theme:"default",disabled:!p.value.length,onClick:G},{default:a(()=>[...e[8]||(e[8]=[s(" 批量删除 ",-1)])]),_:1},8,["disabled"])),[[h,["adminapi/merchant/cash/delBatch"]]]),p.value.length?(r(),b("p",Se,"已选"+D(p.value.length)+"项",1)):R("",!0)])]),n(Y,{"row-key":"id",data:l(L),columns:l(se),"expand-on-row-click":!1,"expanded-row-keys":y.value,"expand-icon":!1,hover:((C=l(L))==null?void 0:C.length)>0,"header-affixed-top":l(J),pagination:l(M),loading:l(F),"max-height":"100%","selected-row-keys":p.value,onPageChange:l(K),onSelectChange:E},{expandedRow:a(({row:i})=>[s(D(i.collect_info),1)]),operate:a(({row:i})=>[i.status===0?(r(),b("span",ze,[n(P,{size:"small"},{default:a(()=>[_((r(),g(f,{theme:"primary",onClick:S=>W(i.id)},{default:a(()=>[...e[9]||(e[9]=[s("手工打款",-1)])]),_:1},8,["onClick"])),[[h,["adminapi/merchant/cash/pass"]]]),_((r(),g(f,{theme:"primary",onClick:S=>Q("autopass",i.id)},{default:a(()=>[...e[10]||(e[10]=[s("代付打款",-1)])]),_:1},8,["onClick"])),[[h,["adminapi/merchant/cash/autoPass"]]]),_((r(),g(f,{theme:"danger",onClick:S=>H(i.id)},{default:a(()=>[...e[11]||(e[11]=[s("驳回",-1)])]),_:1},8,["onClick"])),[[h,["adminapi/merchant/cash/refuse"]]])]),_:2},1024)])):R("",!0),i.status===1?_((r(),b("span",Ne,[n(f,{theme:"danger",onClick:S=>U(i.id)},{default:a(()=>[...e[12]||(e[12]=[s("删除",-1)])]),_:1},8,["onClick"])])),[[h,["adminapi/merchant/cash/del"]]]):R("",!0)]),_:1},8,["data","columns","expanded-row-keys","hover","header-affixed-top","pagination","loading","selected-row-keys","onPageChange"])]}),_:1})])}}});const $t=ae(Re,[["__scopeId","data-v-f4d5a9c4"]]);export{$t as default};
