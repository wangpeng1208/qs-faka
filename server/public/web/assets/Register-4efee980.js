import{s as O,k as G,l as H,m as K,_ as Q}from"./index-45c41893.js";import{u as j}from"./index-b02b5348.js";import J from"./Agreement-01379969.js";import{M as n,l as W,I as X,F as Y,B as Z,K as ee,e as se}from"./ui-ba7aaa7e.js";import{e as te,r as _,P as i,Q as h,f as a,a4 as o,a3 as c,a9 as p,I as v,H as b,ab as E,a7 as x,n as ae,ac as oe,ad as re}from"./vue-bf422dc1.js";import"./libs-51817cd7.js";import"./plugins-ca970193.js";import"./others-9f318174.js";import"./echarts-bf9d612c.js";import"./icons-a8498fb6.js";const R=k=>(oe("data-v-22b860d0"),k=k(),re(),k),le={key:0},ie=R(()=>x("span",null,"服务协议",-1)),ne=R(()=>x("span",null," 隐私声明",-1)),me={key:1},de={class:"register-close"},ue={class:"item-container"},_e=te({__name:"Register",emits:["registerSuccess"],setup(k,{emit:U}){const w={site_register_status:!0,site_register_smscode_status:!0,site_register_code_type:"sms",site_register_need_username:!1,site_register_need_mobile:!0,site_register_need_mobile_check:!0,site_register_need_email:!1,site_register_need_email_check:!1},t=_({...w}),[g,C]=j(),z=_(""),N=()=>{if(!s.value.mobile){n.error("请输入手机号");return}T()},T=async(d={})=>{const e={screen:"register",mobile:s.value.mobile,...d},r=await O(e);r.code===1?(n.success(r.msg),C()):n.error(r.msg)},q=async()=>{const d={token:z.value,screen:"verify_code",email:s.value.email},e=await G(d);e.code===1?(n.success(e.msg),C()):n.error(e.msg)},s=_({...{username:"",email:"",mobile:"",password:"",checkboxEd:!1,email_code:"",mobile_code:"",invite_code:""}}),m={},B=()=>{t.value.site_register_need_username&&(m.username=[{required:!0,message:"用户名必填",type:"error"}]),t.value.site_register_need_email&&(m.email=[{required:!0,message:"邮箱必填",type:"error"}],m.email.push({email:!0,message:"请输入正确的邮箱",type:"warning"})),t.value.site_register_need_mobile&&(m.mobile=[{required:!0,message:"手机号必填",type:"error"}]),t.value.site_register_need_mobile&&t.value.site_register_need_mobile_check&&(m.mobile_code=[{required:!0,message:"手机验证码必填",type:"error"}]),t.value.site_register_need_email&&t.value.site_register_need_email_check&&(m.email_code=[{required:!0,message:"邮箱验证码必填",type:"error"}]),m.password=[{required:!0,message:"密码必填",type:"error"}]},D=_(),y=_(!1),F=U,P=d=>{if(d.validateResult===!0){if(!s.value.checkboxEd){n.error("请同意注册协议 和 隐私政策");return}H({reginfo:s.value}).then(e=>{e.code===1?(n.success("注册成功"),F("registerSuccess")):n.error(e.msg)}).catch(()=>{n.error("注册失败")})}},I=_(!0);(async()=>{const d=await K(),{code:e,data:r}=d;e===1&&(t.value={...w,...r},B(),I.value=!1)})();const L=()=>{s.value.checkboxEd=!0},S=_(),A=async()=>{await ae(),S.value.init(s.value.checkboxEd)};return A(),(d,e)=>{const r=W,f=X,u=Y,V=Z,M=ee,$=se;return i(),h("div",null,[t.value.site_register_status?(i(),h("div",le,[a($,{ref_key:"form",ref:D,loading:I.value,class:"item-container",data:s.value,rules:m,"label-width":"0",onSubmit:P},{default:o(()=>[t.value.site_register_need_username?(i(),c(u,{key:0,name:"username"},{default:o(()=>[a(f,{modelValue:s.value.username,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.username=l),type:"text",size:"large",placeholder:"请输入用户名"},{"prefix-icon":o(()=>[a(r,{name:"user"})]),_:1},8,["modelValue"])]),_:1})):p("",!0),t.value.site_register_need_email?(i(),c(u,{key:1,name:"email"},{default:o(()=>[a(f,{modelValue:s.value.email,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.email=l),type:"text",size:"large",placeholder:"请输入邮箱"},{"prefix-icon":o(()=>[a(r,{name:"mail"})]),_:1},8,["modelValue"])]),_:1})):p("",!0),t.value.site_register_need_email_check&&t.value.site_register_need_email?(i(),c(u,{key:2,name:"email_code",class:"code"},{default:o(()=>[a(f,{modelValue:s.value.email_code,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.email_code=l),size:"large",placeholder:"请输入邮箱验证码"},{"prefix-icon":o(()=>[a(r,{name:"mail"})]),_:1},8,["modelValue"]),t.value.site_register_need_email_check&&t.value.site_register_need_email?(i(),c(V,{key:0,variant:"outline",disabled:v(g)>0,onClick:q},{default:o(()=>[b(E(v(g)==0?"获取验证码":`${v(g)}秒后可重发`),1)]),_:1},8,["disabled"])):p("",!0)]),_:1})):p("",!0),t.value.site_register_need_mobile?(i(),c(u,{key:3,name:"mobile"},{default:o(()=>[a(f,{modelValue:s.value.mobile,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.mobile=l),size:"large",placeholder:"请输入您的手机号"},{"prefix-icon":o(()=>[a(r,{name:"mobile"})]),_:1},8,["modelValue"])]),_:1})):p("",!0),t.value.site_register_need_mobile_check&&t.value.site_register_need_mobile?(i(),c(u,{key:4,name:"mobile_code",class:"code"},{default:o(()=>[a(f,{modelValue:s.value.mobile_code,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.mobile_code=l),size:"large",placeholder:"请输入手机验证码"},{"prefix-icon":o(()=>[a(r,{name:"mobile"})]),_:1},8,["modelValue"]),t.value.site_register_need_mobile_check&&t.value.site_register_need_mobile?(i(),c(V,{key:0,variant:"outline",disabled:v(g)>0,onClick:N},{default:o(()=>[b(E(v(g)==0?"获取验证码":`${v(g)}秒后可重发`),1)]),_:1},8,["disabled"])):p("",!0)]),_:1})):p("",!0),a(u,{name:"password"},{default:o(()=>[a(f,{modelValue:s.value.password,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.password=l),size:"large",type:y.value?"text":"password",clearable:"",placeholder:"请输入登录密码",autocomplete:" "},{"prefix-icon":o(()=>[a(r,{name:"lock-on"})]),"suffix-icon":o(()=>[a(r,{name:y.value?"browse":"browse-off",onClick:e[5]||(e[5]=l=>y.value=!y.value)},null,8,["name"])]),_:1},8,["modelValue","type"])]),_:1}),a(u,{class:"check-container",name:"checkboxEd",onClick:A},{default:o(()=>[a(M,{modelValue:s.value.checkboxEd,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.checkboxEd=l)},{default:o(()=>[b("我已阅读并同意 ")]),_:1},8,["modelValue"]),ie,b(" 和 "),ne]),_:1}),a(J,{ref_key:"agreementRef",ref:S,onSuccess:L},null,512),a(V,{block:"",size:"large",type:"submit"},{default:o(()=>[b(" 注册 ")]),_:1})]),_:1},8,["loading","data"])])):(i(),h("div",me,[x("div",de,[x("div",ue,[a(r,{name:"close"}),b(" 系统已关闭注册 ")])])]))])}}});const Ce=Q(_e,[["__scopeId","data-v-22b860d0"]]);export{Ce as default};
