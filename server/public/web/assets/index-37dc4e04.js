import{e as Q,r as g,a8 as z,l as J,P as u,a3 as v,a4 as e,f as o,I as r,H as d,Q as k,ab as W,a9 as $,a7 as w,ac as X,ad as Y}from"./vue-bf422dc1.js";import{d as L,f as Z,c as ee,l as te}from"./card-c6ac5d29.js";import{l as oe}from"./category-7ca503b8.js";import{g as ae}from"./good-8f08fe48.js";import{R as se}from"./index-efe651b4.js";import{t as ne}from"./table-fedd62e5.js";import{s as le,l as ie}from"./constant-7e13a34d.js";import re from"./detail-488e114f.js";import{T as de}from"./icons-a8498fb6.js";import{m as x,M as c,l as ce,B as me,d as ue,I as pe,S as _e,T as fe,L as he,j as ge,b as ve}from"./ui-ba7aaa7e.js";import{_ as ye}from"./index-c2dd6a24.js";import"./no-list-e2f85d5e.js";import"./global-0d825ba6.js";import"./date-20546ee0.js";import"./libs-51817cd7.js";import"./plugins-ca970193.js";import"./others-9f318174.js";import"./echarts-bf9d612c.js";const Ce=h=>(X("data-v-2360def7"),h=h(),Y(),h),be=Ce(()=>w("span",{style:{"padding-right":"20px"}},"库存列表",-1)),ke={key:0,class:"selected-count"},xe={class:"category-header"},Ve={key:0,style:{color:"rgb(8, 43, 139)"}},De={key:1},Se={name:"CardIndex"},Ie=Q({...Se,setup(h){const V=g(),D=g();(async()=>{V.value=(await oe()).data.list??[],D.value=(await ae()).data??[]})();const y=z(),i=J({cate_id:"",goods_id:"",number:"",status:""}),{pagination:P,fetchData:_,dataLoading:T,headerAffixedTop:N,rehandlePageChange:O,lists:U,searchData:j}=ne({fetchFun:te,params:i});_();const{query:S}=y.currentRoute.value;Object.keys(S).forEach(a=>{i[a]!==void 0&&(i[a]=Number(S[a]))});const m=g([]),E=a=>{m.value=a},I=g(null),F=async a=>{I.value.init(a)},G=async a=>{const t=x({header:"提醒",body:"是否确认删除？",confirmBtn:"确认",onConfirm:({e:n})=>{t.hide();const{id:l}=a;L({ids:[l]}).then(f=>{f.code===1?(c.success("删除成功"),_()):c.error(`${f.msg}`)}).catch(f=>{c.error("删除失败")})},onClose:({e:n,trigger:l})=>{t.hide()}})},M=a=>{const{id:t,is_first:n}=a;Z({id:t,status:n===1?0:1}).then(p=>{p.code===1&&_()})},q=async()=>{const a=x({header:"提醒",body:"是否确认删除？点击确认后删除的卡密将被放置回收站",confirmBtn:"确认",onConfirm:({e:t})=>{a.hide();const n={ids:m.value};L(n).then(l=>{l.code===1?(_(),c.success("删除成功"),m.value=[]):c.error(`删除失败：${l.msg}`)}).catch(l=>{c.error("删除失败")})},onClose:({e:t,trigger:n})=>{a.hide()}})},A=async()=>{const a=x({header:"提醒",body:"确定要清空卡密库存吗？点击确认后，卡密库存将被移至回收站！",confirmBtn:"确认",onConfirm:({e:t})=>{a.hide(),ee().then(n=>{n.code===1?(_(),c.success("清空成功")):c.error(`清空失败：${n.msg}`)}).catch(n=>{c.error("清空失败")})},onClose:({e:t,trigger:n})=>{a.hide()}})};return(a,t)=>{const n=ce,l=me,p=ue,f=pe,B=_e,C=fe,b=he,H=ge,K=ve;return u(),v(K,{title:"库存列表",class:"basic-container",bordered:!1},{title:e(()=>[be,o(l,{theme:"primary",onClick:t[0]||(t[0]=s=>r(y).push("/merchant/goods/card/add"))},{icon:e(()=>[o(n,{name:"add"})]),default:e(()=>[d(" 添加库存 ")]),_:1}),o(l,{theme:"danger",onClick:A},{default:e(()=>[d(" 全部清空 ")]),_:1}),o(l,{theme:"default",disabled:!m.value.length,onClick:q},{default:e(()=>[d(" 批量删除 ")]),_:1},8,["disabled"]),m.value.length?(u(),k("p",ke,"已选"+W(m.value.length)+"项",1)):$("",!0)]),actions:e(()=>[o(l,{variant:"text",theme:"default",onClick:t[1]||(t[1]=s=>r(y).push("/merchant/goods/card/trash"))},{icon:e(()=>[o(n,{name:"delete"})]),default:e(()=>[d(" 回收站 ")]),_:1})]),default:e(()=>[w("div",xe,[o(B,null,{default:e(()=>[o(p,{modelValue:i.cate_id,"onUpdate:modelValue":t[2]||(t[2]=s=>i.cate_id=s),placeholder:"全部分类",clearable:"",options:V.value},null,8,["modelValue","options"]),o(p,{modelValue:i.goods_id,"onUpdate:modelValue":t[3]||(t[3]=s=>i.goods_id=s),placeholder:"全部商品",clearable:"",options:D.value,keys:{value:"id",label:"name"}},null,8,["modelValue","options"]),o(p,{modelValue:i.status,"onUpdate:modelValue":t[4]||(t[4]=s=>i.status=s),placeholder:"全部状态",clearable:"",options:r(le)},null,8,["modelValue","options"]),o(f,{modelValue:i.number,"onUpdate:modelValue":t[5]||(t[5]=s=>i.number=s),placeholder:"请输入关键词",clearable:""},{"suffix-icon":e(()=>[o(r(de))]),_:1},8,["modelValue"]),o(l,{theme:"primary",onClick:r(j)},{default:e(()=>[d("查询")]),_:1},8,["onClick"])]),_:1})]),o(H,{data:r(U),columns:r(ie),"row-key":"id",pagination:r(P),"selected-row-keys":m.value,loading:r(T),"header-affixed-top":r(N),"max-height":"auto","table-layout":"auto",onPageChange:r(O),onSelectChange:E},{status:e(({row:s})=>[s.status===2?(u(),v(C,{key:0,variant:"light",theme:"success"},{default:e(()=>[d("已售")]),_:1})):(u(),v(C,{key:1,variant:"light",theme:"danger"},{default:e(()=>[d("未售")]),_:1})),s.is_cross===1?(u(),v(C,{key:2,variant:"light",theme:"success"},{default:e(()=>[d("跨站")]),_:1})):$("",!0)]),operation:e(({row:s})=>[o(B,null,{default:e(()=>[o(b,{theme:"primary",hover:"color",onClick:R=>M(s)},{default:e(()=>[s.is_first===1?(u(),k("span",Ve," 取消优先 ")):(u(),k("span",De," 优先销售 "))]),_:2},1032,["onClick"]),o(b,{theme:"primary",hover:"color",onClick:R=>F(s)},{default:e(()=>[d("查看")]),_:2},1032,["onClick"]),o(b,{theme:"danger",hover:"color",onClick:R=>G(s)},{default:e(()=>[d("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),empty:e(()=>[o(se,{title:"",tip:"库存为空",type:"list"})]),_:1},8,["data","columns","pagination","selected-row-keys","loading","header-affixed-top","onPageChange"]),o(re,{ref_key:"cardDetailRef",ref:I},null,512)]),_:1})}}});const Qe=ye(Ie,[["__scopeId","data-v-2360def7"]]);export{Qe as default};
