import{f as h}from"./date-97dddb73.js";import{r as p,M as C,_ as A}from"./index-ebc513dd.js";import{T as x}from"./index-f001b1b6.js";import{D as F}from"./plugin-41574ab4.js";import{C as I}from"./index-0945ca82.js";import{D as w}from"./index-70c93031.js";import{d as D,t as E,b as T,r as O,A as G,l as m,V as q,W as _,a0 as s,M as v,a3 as l,m as g,G as L,a5 as U,_ as b,a4 as W,u as $}from"./vue-51c2f431.js";function _t(i){return p.post({url:"/adminapi/order/order/list",params:i})}function ut(i){return p.post({url:"/adminapi/order/order/del",params:i})}function vt(){return p.post({url:"/adminapi/order/order/clear"})}function H(i){return p.post({url:"/adminapi/order/order/notify",params:i})}function J(i){return p.post({url:"/adminapi/order/order/freeze",params:i})}const S=[{label:"未支付",value:0,theme:"warning"},{label:"已支付",value:1,theme:"success"},{label:"已关闭",value:2,theme:"danger"},{label:"已退款",value:3,theme:"warning"}],ft=[{width:"160px",colKey:"trade_no",title:"订单号",fixed:"left"},{colKey:"merchant_info",width:"200px",title:"商户信息",cell:(i,{row:o})=>i("div",{class:"merchant-info-cell"},[i("div",{style:"font-weight: 500; color: #0052d9; margin-bottom: 2px; font-size: 12px;"},`店铺: ${o.shop.shop_name}`),i("div",{style:"color: #333; margin-bottom: 2px; font-size: 12px;"},`商品: ${o.goods_name}`),i("div",{style:"color: #666; font-size: 12px;"},`商户: ${o.user.username}`)])},{colKey:"buyer_info",width:"180px",title:"买家资料",cell:(i,{row:o})=>i("div",{class:"buyer-info-cell"},[i("div",{style:"color: #333; margin-bottom: 2px; font-size: 12px;"},`联系: ${o.contact}`),i("div",{style:"color: #666; font-size: 12px;"},[`购买: ${o.quantity}件 `,i("span",{style:"color: #e37318; font-weight: 500;"},`¥${o.total_price}`)])])},{colKey:"status_info",width:"140px",title:"状态信息",cell:(i,{row:o})=>{const n=S.find(r=>r.value===o.status),u=i(x,{theme:n.theme,variant:"light",size:"small"},()=>n==null?void 0:n.label),d=i(x,{theme:o.cards_count===o.quantity?"success":"warning",variant:"light",size:"small",style:"margin-top: 4px;"},()=>o.cards_count===0?"未取卡":o.cards_count===o.quantity?"已取卡":"部分取卡");return i("div",{class:"status-info-cell"},[u,d])}},{width:"140px",colKey:"create_at",title:"下单时间",cell:(i,{row:o})=>h(o.create_at)},{width:"60px",colKey:"operate",title:"操作",fixed:"right"}],K=(i,o,n)=>{const u=F.confirm({header:"提醒",body:n,confirmBtn:{content:"提交",theme:"primary",loading:!1},closeOnOverlayClick:!1,onConfirm:async()=>{const d=await o({id:i.id});d.code===1?(C.success(d.msg),i=Object.assign(i,d.data),u.hide()):C.error(d.msg)}})},mt=i=>{let o;i.is_freeze===1?o="确认要解冻吗？":o="确认要冻结吗？此处用于存在投诉争议的订单，手工冻结。冻结后，该订单将不会被自动退款，也不会被自动结算。",K(i,J,o)},pt=i=>{K(i,H,"确认要设置这个订单已支付吗？该操作不可恢复")},yt=(i,o,n,u,d)=>{const r=[{content:"详情",value:"detail",onClick:()=>o(i)}];return i.status===0&&r.push({content:"补单",value:"notify",onClick:()=>u(i)}),i.status===1&&r.push({content:i.is_freeze?"解冻":"冻结",value:"freeze",onClick:()=>d(i)}),r.push({content:"删除",value:"delete",onClick:()=>n(i)}),r},Q={class:"order-detail-container"},X={class:"info-grid"},Y={class:"info-item"},Z={class:"value primary"},ss={class:"info-item"},ts={class:"value"},es={class:"info-item"},is={class:"value"},os={class:"info-item"},ls={class:"value"},as={class:"info-grid"},ns={class:"info-item"},ds={class:"value"},cs={class:"info-item"},rs={class:"value"},_s={class:"info-grid"},us={class:"info-item"},vs={class:"value"},fs={class:"info-item"},ms={class:"value"},ps={class:"info-item"},ys={class:"value price"},gs={class:"info-item"},bs={class:"value"},hs={class:"info-item"},xs={class:"value"},ks={key:0,class:"coupon"},zs={key:1,class:"text-gray"},Cs={class:"info-item"},Ts={class:"value price-total"},Os={class:"info-grid"},qs={class:"info-item"},$s={class:"value"},Ss={class:"pay-type"},Ks=["src"],Bs={class:"info-item"},Ns={class:"value"},Ps={class:"info-item"},Vs={class:"value"},js={class:"info-item"},Ms={class:"value"},Rs={class:"info-grid"},As={class:"info-item"},Fs={class:"value"},Is={class:"info-item"},ws={class:"value"},Ds={class:"info-item"},Es={class:"value"},Gs={class:"info-item"},Ls={class:"value"},Us={class:"info-grid"},Ws={class:"info-item"},Hs={class:"value"},Js={class:"info-item"},Qs={class:"value"},Xs={class:"info-item"},Ys={class:"value"},Zs={class:"info-item"},st={class:"value"},tt={name:"RowDetail"},et=D({...tt,props:{payTypeOptions:{type:Array,default:()=>[]}},setup(i,{expose:o}){const n=i,{payTypeOptions:u}=E(n),d=T(()=>{var c;return(c=u.value.find(t=>t.value===e.paytype))==null?void 0:c.label}),r=()=>{var c;return(c=u.value.find(t=>t.value===e.paytype))==null?void 0:c.ico},B=T(()=>S.filter(c=>c.value===e.status)),N=()=>e.cards_count===0?"warning":e.cards_count>=e.quantity?"success":"primary",P=()=>e.cards_count===0?"未取卡":e.cards_count>=e.quantity?"已取卡":`已取部分 (${e.cards_count}/${e.quantity})`,V=O("订单详情"),y=O(!1),e=G({}),j=c=>{y.value=!0,Object.assign(e,c)},M=()=>{y.value=!1};return o({init:j}),(c,t)=>{const k=x,f=I,R=w;return m(),q(R,{visible:y.value,"onUpdate:visible":t[0]||(t[0]=a=>y.value=a),"close-on-overlay-click":!1,size:"60%","destroy-on-close":!0,header:V.value,"on-confirm":M},{default:_(()=>[s("div",Q,[v(f,{title:"订单基本信息",class:"detail-card"},{default:_(()=>[s("div",X,[s("div",Y,[t[1]||(t[1]=s("div",{class:"label"},"订单号",-1)),s("div",Z,l(e.trade_no),1)]),s("div",ss,[t[2]||(t[2]=s("div",{class:"label"},"流水号",-1)),s("div",ts,l((e==null?void 0:e.transaction_id)||"-"),1)]),s("div",es,[t[3]||(t[3]=s("div",{class:"label"},"订单状态",-1)),s("div",is,[(m(!0),g(L,null,U(B.value,a=>(m(),q(k,{key:a.value,theme:a.theme,variant:"light"},{default:_(()=>[b(l(a.label),1)]),_:2},1032,["theme"]))),128))])]),s("div",os,[t[4]||(t[4]=s("div",{class:"label"},"取卡状态",-1)),s("div",ls,[v(k,{theme:N(),variant:"light"},{default:_(()=>[b(l(P()),1)]),_:1},8,["theme"])])])])]),_:1}),v(f,{title:"商户信息",class:"detail-card"},{default:_(()=>{var a,z;return[s("div",as,[s("div",ns,[t[5]||(t[5]=s("div",{class:"label"},"店铺名称",-1)),s("div",ds,l((a=e==null?void 0:e.shop)==null?void 0:a.shop_name),1)]),s("div",cs,[t[6]||(t[6]=s("div",{class:"label"},"商户账号",-1)),s("div",rs,l((z=e==null?void 0:e.user)==null?void 0:z.username),1)])])]}),_:1}),v(f,{title:"商品信息",class:"detail-card"},{default:_(()=>[s("div",_s,[s("div",us,[t[7]||(t[7]=s("div",{class:"label"},"商品名称",-1)),s("div",vs,l(e.goods_name),1)]),s("div",fs,[t[8]||(t[8]=s("div",{class:"label"},"商品数量",-1)),s("div",ms,l(e.quantity)+"件",1)]),s("div",ps,[t[9]||(t[9]=s("div",{class:"label"},"商品单价",-1)),s("div",ys,"¥"+l(e.goods_price),1)]),s("div",gs,[t[10]||(t[10]=s("div",{class:"label"},"商品成本价",-1)),s("div",bs,"¥"+l(e.goods_cost_price),1)]),s("div",hs,[t[11]||(t[11]=s("div",{class:"label"},"优惠券",-1)),s("div",xs,[e.coupon_type?(m(),g("span",ks,"优惠¥"+l(e.coupon_price),1)):(m(),g("span",zs,"未使用"))])]),s("div",Cs,[t[12]||(t[12]=s("div",{class:"label"},"订单总价",-1)),s("div",Ts,"¥"+l(e.total_price),1)])])]),_:1}),v(f,{title:"支付信息",class:"detail-card"},{default:_(()=>{var a;return[s("div",Os,[s("div",qs,[t[13]||(t[13]=s("div",{class:"label"},"支付类型",-1)),s("div",$s,[s("div",Ss,[r()?(m(),g("img",{key:0,src:r(),class:"pay-icon"},null,8,Ks)):W("",!0),b(" "+l(d.value),1)])])]),s("div",Bs,[t[14]||(t[14]=s("div",{class:"label"},"交易通道",-1)),s("div",Ns,l((a=e==null?void 0:e.channel)==null?void 0:a.title),1)]),s("div",Ps,[t[15]||(t[15]=s("div",{class:"label"},"手续费率",-1)),s("div",Vs,l((e.rate*1e3).toFixed(2))+"‰",1)]),s("div",js,[t[16]||(t[16]=s("div",{class:"label"},"手续费",-1)),s("div",Ms,"¥"+l(e.fee),1)])])]}),_:1}),v(f,{title:"买家信息",class:"detail-card"},{default:_(()=>[s("div",Rs,[s("div",As,[t[17]||(t[17]=s("div",{class:"label"},"联系方式",-1)),s("div",Fs,l(e.contact),1)]),s("div",Is,[t[18]||(t[18]=s("div",{class:"label"},"邮件通知",-1)),s("div",ws,l(e.email_notify===1?e.email:"未设置"),1)]),s("div",Ds,[t[19]||(t[19]=s("div",{class:"label"},"短信通知",-1)),s("div",Es,l(e.sms_notify===1?e.contact:"未设置"),1)]),s("div",Gs,[t[20]||(t[20]=s("div",{class:"label"},"取卡密码",-1)),s("div",Ls,l(e.take_card_type===2?e.take_card_password:"未设置"),1)])])]),_:1}),v(f,{title:"时间信息",class:"detail-card"},{default:_(()=>[s("div",Us,[s("div",Ws,[t[21]||(t[21]=s("div",{class:"label"},"提交时间",-1)),s("div",Hs,l($(h)(e.create_at)),1)]),s("div",Js,[t[22]||(t[22]=s("div",{class:"label"},"提交IP",-1)),s("div",Qs,l(e.create_ip),1)]),s("div",Xs,[t[23]||(t[23]=s("div",{class:"label"},"完成时间",-1)),s("div",Ys,l(e.success_at>0?$(h)(e.success_at):"未完成"),1)]),s("div",Zs,[t[24]||(t[24]=s("div",{class:"label"},"总成本价",-1)),s("div",st,"¥"+l(e.total_cost_price),1)])])]),_:1})])]),_:1},8,["visible","header"])}}});const it=A(et,[["__scopeId","data-v-1391ed14"]]),gt=Object.freeze(Object.defineProperty({__proto__:null,default:it},Symbol.toStringTag,{value:"Module"}));export{it as R,vt as a,yt as b,ft as c,pt as d,ut as e,gt as f,mt as h,_t as l};
