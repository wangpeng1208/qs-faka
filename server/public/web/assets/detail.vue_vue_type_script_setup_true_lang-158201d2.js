import{f as v}from"./date-35f9fa82.js";import{r as m,M as K}from"./index-5ae314bf.js";import{T as x}from"./index-2468d71f.js";import{B as z}from"./index-227fbf78.js";import{L}from"./index-5a96e289.js";import{D as M}from"./plugin-e4c34710.js";import{D as N,a as R}from"./index-25e59794.js";import{D as S}from"./index-69eb63ad.js";import{d as V,t as j,b as C,r as O,A as I,l as u,V as q,W as a,M as r,_ as o,a3 as n,m as _,G as y,a5 as E,u as B}from"./vue-d500b9b9.js";function ce(t){return m.post({url:"/adminapi/order/order/list",params:t})}function de(t){return m.post({url:"/adminapi/order/order/del",params:t})}function ue(){return m.post({url:"/adminapi/order/order/clear"})}function G(t){return m.post({url:"/adminapi/order/order/notify",params:t})}function U(t){return m.post({url:"/adminapi/order/order/refund",params:t})}function W(t){return m.post({url:"/adminapi/order/order/freeze",params:t})}const P=[{label:"未支付",value:0,theme:"warning"},{label:"已支付",value:1,theme:"success"},{label:"已关闭",value:2,theme:"danger"},{label:"已退款",value:3,theme:"warning"}],fe=[{width:"180px",colKey:"trade_no",title:"订单号",fixed:"left"},{colKey:"shop_name",width:"180px",title:"店铺名",cell:(t,{row:l})=>`${l.shop.shop_name}`},{colKey:"username",width:"180px",title:"商户名",cell:(t,{row:l})=>`${l.user.username}`},{colKey:"goods_name",width:"180px",title:"商品名"},{colKey:"contact",width:"180px",title:"联系方式"},{colKey:"quantity",width:"100px",title:"商品数量"},{colKey:"total_price",title:"订单金额"},{colKey:"fee",title:"手续费"},{colKey:"rate",title:"手续费率",cell:(t,{row:l})=>`${(l.rate*1e3).toFixed(2)}‰`},{colKey:"channel",title:"支付渠道",cell:(t,{row:l})=>`${l.channel.title}`},{width:"150px",colKey:"status",title:"订单状态",fixed:"right",cell:(t,{row:l})=>{const i=P.find(g=>g.value===l.status),p=t(x,{theme:i.theme,variant:"light"},()=>i==null?void 0:i.label);let c;return l.status===1?c=t(z,{vPerms:"['admin/order/order/refund']",hover:"color",size:"small",style:"margin-left: 10px",onClick:()=>{J(l)}},()=>"退款"):l.status===0?c=t(z,{vPerms:"['admin/order/order/notify']",hover:"color",size:"small",onClick:()=>{H(l)}},()=>"补单"):c="",[p,c]}},{colKey:"cards_count",title:"取卡状态",fixed:"right",cell:(t,{row:l})=>t(x,{theme:l.cards_count===l.quantity?"success":"warning",variant:"light"},()=>l.cards_count===0?"未取卡":l.cards_count===l.quantity?"已取卡":"部分取卡")},{colKey:"is_freeze",title:"冻结",fixed:"right",cell:(t,{row:l})=>{let i="";return l.status===1&&(i=t(L,{theme:l.is_freeze?"danger":"success",vPerms:"['admin/order/order/freeze']",hover:"color",onClick:()=>{Q(l)}},()=>l.is_freeze?"解冻":"冻结")),i}},{width:"200px",colKey:"create_at",title:"下单时间",cell:(t,{row:l})=>v(l.create_at)},{width:"100px",colKey:"operate",title:"操作",fixed:"right"}],k=(t,l,i)=>{const p=M.confirm({header:"提醒",body:i,confirmBtn:{content:"提交",theme:"primary",loading:!1},closeOnOverlayClick:!1,onConfirm:async()=>{const c=await l({id:t.id});c.code===1?(K.success(c.msg),t=Object.assign(t,c.data),p.hide()):K.error(c.msg)}})},H=t=>{k(t,G,"确认要设置这个订单已支付吗？该操作不可恢复")},J=t=>{k(t,U,"确认要退款吗？该操作不可恢复")},Q=t=>{let l;t.is_freeze===1?l="确认要解冻吗？":l="确认要冻结吗？此处用于存在投诉争议的订单，手工冻结。冻结后，该订单将不会被自动退款，也不会被自动结算。",k(t,W,l)},X={key:0},Y={key:1},Z={name:"RowDetail"},_e=V({...Z,props:{payTypeOptions:{type:Array,default:()=>[]}},setup(t,{expose:l}){const i=t,{payTypeOptions:p}=j(i),c=C(()=>{var f;return(f=p.value.find(b=>b.value===e.paytype))==null?void 0:f.label}),g=C(()=>P.filter(f=>f.value===e.status)),T=O("订单详情"),h=O(!1),e=I({}),D=f=>{h.value=!0,Object.assign(e,f)},$=()=>{h.value=!1};return l({init:D}),(f,b)=>{const s=N,w=x,A=R,F=S;return u(),q(F,{visible:h.value,"onUpdate:visible":b[0]||(b[0]=d=>h.value=d),"close-on-overlay-click":!1,size:"50%","destroy-on-close":!0,header:T.value,"on-confirm":$},{default:a(()=>[r(A,{title:`${e.trade_no}的订单详情`},{default:a(()=>[r(s,{label:"商户账号"},{default:a(()=>{var d;return[o(n((d=e==null?void 0:e.user)==null?void 0:d.username),1)]}),_:1}),r(s,{label:"流水号"},{default:a(()=>[o(n(e==null?void 0:e.transaction_id),1)]),_:1}),r(s,{label:"商品名称"},{default:a(()=>[o(n(e.goods_name),1)]),_:1}),r(s,{label:"商品数量"},{default:a(()=>[o(n(e.quantity),1)]),_:1}),r(s,{label:"商品单价"},{default:a(()=>[o(n(e.goods_price),1)]),_:1}),r(s,{label:"商品成本价"},{default:a(()=>[o(n(e.goods_cost_price),1)]),_:1}),r(s,{label:"优惠券"},{default:a(()=>[e.coupon_type?(u(),_("span",X,"优惠"+n(e.coupon_price)+"元",1)):(u(),_("span",Y,"未使用"))]),_:1}),r(s,{label:"总价"},{default:a(()=>[o(n(e.total_price),1)]),_:1}),r(s,{label:"总成本价"},{default:a(()=>[o(n(e.total_cost_price),1)]),_:1}),r(s,{label:"取卡密码"},{default:a(()=>[o(n(e.take_card_type===2?e.take_card_password:"未设置"),1)]),_:1}),r(s,{label:"联系方式"},{default:a(()=>[o(n(e.contact),1)]),_:1}),r(s,{label:"邮件通知"},{default:a(()=>[o(n(e.email_notify===1?e.email:"未设置"),1)]),_:1}),r(s,{label:"短信通知"},{default:a(()=>[o(n(e.sms_notify===1?e.contact:"未设置"),1)]),_:1}),r(s,{label:"支付类型"},{default:a(()=>[o(n(c.value),1)]),_:1}),r(s,{label:"交易通道"},{default:a(()=>{var d;return[o(n((d=e==null?void 0:e.channel)==null?void 0:d.title),1)]}),_:1}),r(s,{label:"手续费率"},{default:a(()=>[o(n(e.rate*1e3)+"‰",1)]),_:1}),r(s,{label:"手续费"},{default:a(()=>[o(n(e.fee),1)]),_:1}),r(s,{label:"状态"},{default:a(()=>[(u(!0),_(y,null,E(g.value,d=>(u(),q(w,{key:d.value,theme:d.theme},{default:a(()=>[o(n(d.label),1)]),_:2},1032,["theme"]))),128))]),_:1}),r(s,{label:"取卡状态"},{default:a(()=>[e.cards_count>0?(u(),_(y,{key:0},[e.cards_count>=e.quantity?(u(),_(y,{key:0},[o(" 已取 ")],64)):(u(),_(y,{key:1},[o(" 已取部分 ")],64))],64)):(u(),_(y,{key:1},[o(" 未取 ")],64))]),_:1}),r(s,{label:"提交时间"},{default:a(()=>[o(n(B(v)(e.create_at)),1)]),_:1}),r(s,{label:"提交IP"},{default:a(()=>[o(n(e.create_ip),1)]),_:1}),r(s,{label:"完成时间"},{default:a(()=>[o(n(e.success_at>0?B(v)(e.success_at):""),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["visible","header"])}}});export{_e as _,ue as a,fe as c,de as d,ce as l};
