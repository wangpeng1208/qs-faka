import{d as j,a2 as E,A as H,r as C,o as J,l as p,V as u,W as e,M as a,u as i,_ as n,a0 as c,a3 as $,a4 as g,n as K}from"./vue-51c2f431.js";import{l as Q}from"./category-baa68958.js";import{s as X,l as Y}from"./good-95e904d5.js";import{R as Z}from"./index-add4fbe3.js";import{t as tt}from"./table-2bc65021.js";import{u as et}from"./useBatchAction-1c377cbb.js";import{f as ot}from"./date-97dddb73.js";import at from"./GoodsLink-2d6589b5.js";import{c as it}from"./constant-6bc153e8.js";import{M as V,L as nt}from"./index-ebc513dd.js";import{I as rt}from"./index-69f74367.js";import{B as st}from"./index-3b3d7414.js";import{S as lt}from"./index-31ca20e2.js";import{I as mt}from"./index-15716071.js";import{S as dt}from"./index-b206f515.js";import{T as pt}from"./index-f001b1b6.js";import{S as ut}from"./index-8ea8c9a9.js";import{L as ct}from"./index-e2e71093.js";import{B as ft}from"./index-b0e918ce.js";import{C as _t}from"./index-0945ca82.js";import"./no-list-e2f85d5e.js";import"./global-0d825ba6.js";import"./plugin-41574ab4.js";import"./dialog-2582254b.js";import"./dep-cc1906a8-b100bfdb.js";import"./dep-581cd4f1-7aa320e3.js";import"./omit-7a5ea809.js";import"./libs-1cd01688.js";import"./link-c1c2b97b.js";import"./link-be654891.js";import"./index-b07945fd.js";import"./dep-0742ae64-e2730b23.js";import"./dep-34b004f3-3e1a5725.js";import"./isNil-c75b1b34.js";import"./index-c22455b5.js";import"./plugins-ccea0c8f.js";import"./others-24e1b5c5.js";import"./echarts-a13411ed.js";import"./fake-arrow-cad1ce15.js";import"./index-e2b6bb2b.js";import"./index-7eef5ecd.js";import"./_baseSet-75352e55.js";import"./close-circle-filled-9eb22673.js";import"./index-d5e568e3.js";import"./index-9aa638bc.js";import"./useLengthLimit-207427cf.js";import"./browse-ff8f6fe8.js";import"./index-78761eb8.js";import"./_baseDifference-5ee4bc76.js";import"./index-b3f3b742.js";import"./index-8fdc26dc.js";import"./dep-ef1abd17-ab5403a7.js";import"./add-06b22f1a.js";import"./index-cda4d585.js";import"./chevron-right-0650800f.js";import"./ellipsis-f8b55775.js";import"./form-model-7023f79a.js";import"./dep-b10d5f92-ed24a547.js";const gt={class:"category-header c-flex"},ht={class:"l"},vt={class:"r c-flex"},yt={name:"Goods"},be=j({...yt,setup(kt){const d=E(),l=H({cate_id:null,name:""}),{query:x}=d.currentRoute.value;x.cate_id&&(l.cate_id=+x.cate_id);const{pagination:B,fetchData:h,dataLoading:R,headerAffixedTop:T,rehandlePageChange:z,lists:L,searchData:M}=tt({fetchFun:Y,params:l}),N=C(!1),b=C([]),U=async()=>{const{data:r}=await Q();b.value=r.list};J(()=>{h(),U()});const S=C(),G=async r=>{var t;await K(),(t=S.value)==null||t.init(r.id)},I=async r=>{et({title:"提醒",body:`是否确认删除(${r.name})？`,ids:r.id,url:"/merchantapi/goods/good/del",fetchList:()=>{h()}})},P=async(r,t)=>{try{const s=await X({id:r,val:t});s.code===1?V.success(s.msg):V.error(s.msg)}catch{V.error("修改失败")}},A=r=>{const{id:t}=r;d.push(`/merchant/goods/edit?id=${t}`)};return(r,t)=>{const s=rt,v=st,D=lt,q=mt,y=dt,f=pt,w=ut,_=ct,F=ft,O=nt,W=_t;return p(),u(W,{title:"商品列表",bordered:!1},{actions:e(()=>[a(v,{variant:"text",theme:"default",onClick:t[0]||(t[0]=k=>i(d).push("/merchant/goods/trash"))},{icon:e(()=>[a(s,{name:"delete"})]),default:e(()=>[t[4]||(t[4]=n(" 回收站 ",-1))]),_:1})]),default:e(()=>{var k;return[c("div",gt,[c("div",ht,[a(v,{theme:"primary",onClick:t[1]||(t[1]=o=>i(d).push("/merchant/goods/add"))},{default:e(()=>[...t[5]||(t[5]=[n(" 添加 ",-1)])]),_:1})]),c("div",vt,[a(y,null,{default:e(()=>[a(D,{modelValue:l.cate_id,"onUpdate:modelValue":t[2]||(t[2]=o=>l.cate_id=o),clear:i(h),empty:"没有分类",placeholder:"全部分类",type:"search",clearable:"",options:b.value},null,8,["modelValue","clear","options"]),a(q,{modelValue:l.name,"onUpdate:modelValue":t[3]||(t[3]=o=>l.name=o),placeholder:"请输入商品名",clearable:""},{"suffix-icon":e(()=>[a(s,{name:"search"})]),_:1},8,["modelValue"]),a(v,{theme:"primary",onClick:i(M)},{default:e(()=>[...t[6]||(t[6]=[n("查询",-1)])]),_:1},8,["onClick"])]),_:1})])]),a(F,{data:i(L),columns:i(it),"row-key":"id","vertical-align":"middle",hover:((k=i(L))==null?void 0:k.length)>0,pagination:i(B),loading:i(R),"header-affixed-top":i(T),"table-layout":"auto","max-height":"100%",onPageChange:i(z)},{name:e(({row:o})=>[a(y,{direction:"vertical",size:"small",class:"tag-demo light"},{default:e(()=>[c("span",null,[n($(o.name)+" ",1),o.wholesale_discount==1?(p(),u(f,{key:0,title:"支持批发优惠",theme:"success",variant:"light",size:"small",shape:"round"},{default:e(()=>[...t[7]||(t[7]=[n("惠",-1)])]),_:1})):g("",!0),o.coupon_type==1?(p(),u(f,{key:1,title:"支持优惠券",theme:"primary",variant:"light",size:"small",shape:"round"},{default:e(()=>[...t[8]||(t[8]=[n("券",-1)])]),_:1})):g("",!0),o.take_card_type!=0?(p(),u(f,{key:2,title:"提卡必填或选填取卡密码",theme:"warning",variant:"light",size:"small",shape:"round"},{default:e(()=>[...t[9]||(t[9]=[n("取",-1)])]),_:1})):g("",!0),o.visit_type==1?(p(),u(f,{key:3,title:"商品购买页面需要访问密码",theme:"danger",variant:"light",size:"small",shape:"round"},{default:e(()=>[...t[10]||(t[10]=[n("密",-1)])]),_:1})):g("",!0)])]),_:2},1024)]),status:e(({row:o})=>[a(w,{modelValue:o.status,"onUpdate:modelValue":m=>o.status=m,"custom-value":[1,0],onClick:m=>P(o.id,o.status)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),create_at:e(({row:o})=>[c("span",null,$(i(ot)(o.create_at)),1)]),operation:e(({row:o})=>[a(y,null,{default:e(()=>[a(_,{theme:"primary",hover:"color",onClick:m=>G(o)},{default:e(()=>[...t[11]||(t[11]=[n("链接",-1)])]),_:1},8,["onClick"]),a(_,{theme:"primary",hover:"color",onClick:m=>i(d).push(`/merchant/goods/card/add?goods_id=${o.id}`)},{default:e(()=>[...t[12]||(t[12]=[n("加库存",-1)])]),_:1},8,["onClick"]),a(_,{theme:"primary",hover:"color",onClick:m=>A(o)},{default:e(()=>[...t[13]||(t[13]=[n("编辑",-1)])]),_:1},8,["onClick"]),a(_,{theme:"danger",hover:"color",onClick:m=>I(o)},{default:e(()=>[...t[14]||(t[14]=[n("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),empty:e(()=>[a(Z,{title:"",tip:"暂无相关数据",type:"list"})]),_:1},8,["data","columns","hover","pagination","loading","header-affixed-top","onPageChange"]),a(O,{loading:N.value,size:"small",fullscreen:""},null,8,["loading"]),a(at,{ref_key:"goodLinkRef",ref:S},null,512)]}),_:1})}}});export{be as default};
