import{d as q,r as f,a2 as K,A as M,l as m,V as v,W as o,a0 as S,M as e,u as r,_ as l,m as b,a3 as W,a4 as z}from"./vue-d500b9b9.js";import{f as H,l as J}from"./card-2fe89aea.js";import{l as Q}from"./category-0a39d79d.js";import{g as X}from"./good-d4ddceee.js";import{R as Y}from"./index-bef910b5.js";import{t as Z}from"./table-48199bef.js";import{u as h}from"./useBatchAction-590dba1a.js";import{s as tt,l as ot}from"./constant-464c480e.js";import et from"./detail-6c608530.js";import at from"./search-a8b831db.js";import{I as it}from"./index-ea2a85c9.js";import{B as st}from"./index-c63cfed1.js";import{S as rt}from"./index-18bbad02.js";import{I as nt}from"./index-757197b9.js";import{S as lt}from"./index-0fc44882.js";import{T as dt}from"./index-b8d4edf9.js";import{L as mt}from"./index-95260792.js";import{T as pt}from"./index-98194870.js";import{C as ut}from"./index-c2a11f34.js";import{_ as ct}from"./index-6b6fbd51.js";import"./no-list-e2f85d5e.js";import"./global-0d825ba6.js";import"./base-9eb484ec.js";import"./plugin-cad85236.js";import"./dialog-8ec74ee0.js";import"./dep-cc1906a8-b100bfdb.js";import"./dep-581cd4f1-15e6aa5c.js";import"./omit-82a91481.js";import"./date-69e2f1fa.js";import"./libs-d79b82a8.js";import"./index-f937956d.js";import"./plugins-f7b3b094.js";import"./others-381f73b9.js";import"./echarts-415f4206.js";import"./index-2132cfb3.js";import"./dep-0742ae64-0833915c.js";import"./fake-arrow-d40b6f7e.js";import"./index-424a7ec0.js";import"./_baseSet-c1826ef2.js";import"./close-circle-filled-3424a47b.js";import"./index-5be2c846.js";import"./dep-34b004f3-3e1a5725.js";import"./index-e205a427.js";import"./useLengthLimit-14a00f39.js";import"./browse-35e2443f.js";import"./index-03ea1434.js";import"./index-d6e54721.js";import"./index-912dcce2.js";import"./dep-ef1abd17-afe34463.js";import"./add-291eb586.js";import"./index-9bccbd74.js";import"./chevron-right-6ae15ba3.js";import"./ellipsis-1db91eb9.js";import"./index-ae3a9dfb.js";import"./isNil-c75b1b34.js";import"./form-model-0fc8dc05.js";import"./dep-b10d5f92-c98df075.js";const ft={key:0,class:"selected-count"},_t={class:"category-header"},gt={key:0,style:{color:"rgb(8, 43, 139)"}},vt={key:1},bt={name:"CardIndex"},ht=q({...bt,setup(yt){const y=f(),C=f();(async()=>{y.value=(await Q()).data.list??[],C.value=(await X()).data??[]})();const _=K(),s=M({cate_id:"",goods_id:"",number:"",status:""}),{pagination:D,fetchData:p,dataLoading:B,headerAffixedTop:I,rehandlePageChange:w,lists:T,searchData:N}=Z({fetchFun:J,params:s});p();const{query:k}=_.currentRoute.value;Object.keys(k).forEach(i=>{s[i]!==void 0&&(s[i]=Number(k[i]))});const n=f([]),O=i=>{n.value=i},V=f(null),$=async i=>{V.value.init(i)},U=i=>{h({title:"提醒",body:"是否确认删除？",ids:i.id,url:"/merchantapi/goods/card/del",fetchList:()=>{p(),n.value=[]}})},A=i=>{const{id:t,is_first:c}=i;H({id:t,status:c===1?0:1}).then(u=>{u.code===1&&p()})},P=()=>{h({title:"提醒",body:"是否确认删除？点击确认后删除的卡密将被放置回收站",ids:n.value,url:"/merchantapi/goods/card/del",fetchList:()=>{p(),n.value=[]}})},E=()=>{h({title:"提醒",body:"确定要清空卡密库存吗？点击确认后，卡密库存将被移至回收站！",ids:n.value,url:"/merchantapi/goods/card/clearGoodsCards",fetchList:()=>{p(),n.value=[]}})};return(i,t)=>{const c=it,d=st,u=rt,F=nt,x=lt,L=dt,g=mt,G=pt,j=ut;return m(),v(j,{class:"basic-container",bordered:!1},{title:o(()=>[t[9]||(t[9]=S("span",{style:{"padding-right":"20px"}},"库存列表",-1)),e(d,{theme:"primary",onClick:t[0]||(t[0]=a=>r(_).push("/merchant/goods/card/add"))},{icon:o(()=>[e(c,{name:"add"})]),default:o(()=>[t[6]||(t[6]=l(" 添加库存 ",-1))]),_:1}),e(d,{theme:"danger",onClick:E},{default:o(()=>[...t[7]||(t[7]=[l(" 全部清空 ",-1)])]),_:1}),e(d,{theme:"default",disabled:!n.value.length,onClick:P},{default:o(()=>[...t[8]||(t[8]=[l(" 批量删除 ",-1)])]),_:1},8,["disabled"]),n.value.length?(m(),b("p",ft,"已选"+W(n.value.length)+"项",1)):z("",!0)]),actions:o(()=>[e(d,{variant:"text",theme:"default",onClick:t[1]||(t[1]=a=>r(_).push("/merchant/goods/card/trash"))},{icon:o(()=>[e(c,{name:"delete"})]),default:o(()=>[t[10]||(t[10]=l(" 回收站 ",-1))]),_:1})]),default:o(()=>[S("div",_t,[e(x,null,{default:o(()=>[e(u,{modelValue:s.cate_id,"onUpdate:modelValue":t[2]||(t[2]=a=>s.cate_id=a),placeholder:"全部分类",clearable:"",options:y.value},null,8,["modelValue","options"]),e(u,{modelValue:s.goods_id,"onUpdate:modelValue":t[3]||(t[3]=a=>s.goods_id=a),placeholder:"全部商品",clearable:"",options:C.value,keys:{value:"id",label:"name"}},null,8,["modelValue","options"]),e(u,{modelValue:s.status,"onUpdate:modelValue":t[4]||(t[4]=a=>s.status=a),placeholder:"全部状态",clearable:"",options:r(tt)},null,8,["modelValue","options"]),e(F,{modelValue:s.number,"onUpdate:modelValue":t[5]||(t[5]=a=>s.number=a),placeholder:"请输入关键词",clearable:""},{"suffix-icon":o(()=>[e(r(at))]),_:1},8,["modelValue"]),e(d,{theme:"primary",onClick:r(N)},{default:o(()=>[...t[11]||(t[11]=[l("查询",-1)])]),_:1},8,["onClick"])]),_:1})]),e(G,{data:r(T),columns:r(ot),"row-key":"id",pagination:r(D),"selected-row-keys":n.value,loading:r(B),"header-affixed-top":r(I),"max-height":"auto","table-layout":"auto",onPageChange:r(w),onSelectChange:O},{status:o(({row:a})=>[a.status===2?(m(),v(L,{key:0,variant:"light",theme:"success"},{default:o(()=>[...t[12]||(t[12]=[l("已售",-1)])]),_:1})):(m(),v(L,{key:1,variant:"light",theme:"danger"},{default:o(()=>[...t[13]||(t[13]=[l("未售",-1)])]),_:1}))]),operation:o(({row:a})=>[e(x,null,{default:o(()=>[e(g,{theme:"primary",hover:"color",onClick:R=>A(a)},{default:o(()=>[a.is_first===1?(m(),b("span",gt," 取消优先 ")):(m(),b("span",vt," 优先销售 "))]),_:2},1032,["onClick"]),e(g,{theme:"primary",hover:"color",onClick:R=>$(a)},{default:o(()=>[...t[14]||(t[14]=[l("查看",-1)])]),_:1},8,["onClick"]),e(g,{theme:"danger",hover:"color",onClick:R=>U(a)},{default:o(()=>[...t[15]||(t[15]=[l("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),empty:o(()=>[e(Y,{title:"",tip:"库存为空",type:"list"})]),_:1},8,["data","columns","pagination","selected-row-keys","loading","header-affixed-top","onPageChange"]),e(et,{ref_key:"cardDetailRef",ref:V},null,512)]),_:1})}}});const Ro=ct(ht,[["__scopeId","data-v-6babb5f6"]]);export{Ro as default};
