import{M as n,bJ as P,bK as $,bL as O,bM as G,_ as J}from"./index-5ae314bf.js";import{u as K}from"./index-c2baa02d.js";import W from"./Agreement-327cf88b.js";import{I as j}from"./index-3d8f650a.js";import{I as H}from"./index-9b4540ef.js";import{F as Q,a as X}from"./index-9de6e4fb.js";import{B as Y}from"./index-227fbf78.js";import{c as Z}from"./index-63b59032.js";import{d as ee,r as _,l,m as V,M as o,W as r,V as c,a4 as p,u as v,_ as b,a3 as R,a0 as y,n as te}from"./vue-d500b9b9.js";import"./libs-035f127b.js";import"./plugins-f7b3b094.js";import"./others-381f73b9.js";import"./echarts-415f4206.js";import"./index-5a96e289.js";import"./index-bf58812f.js";import"./dialog-256f8652.js";import"./dep-cc1906a8-b100bfdb.js";import"./dep-581cd4f1-d83a7af3.js";import"./omit-e39915a9.js";import"./index-9034b695.js";import"./useLengthLimit-bf57acc2.js";import"./browse-50d5b530.js";import"./close-circle-filled-8b5b4fa1.js";import"./dep-0742ae64-334d1564.js";import"./form-model-962c4be8.js";import"./_baseSet-6774bbcb.js";import"./isNil-c75b1b34.js";import"./dep-34b004f3-3e1a5725.js";const se={key:0},oe={key:1},re={class:"register-close"},ae={class:"item-container"},ie=ee({__name:"Register",emits:["registerSuccess"],setup(le,{emit:S}){const w={site_register_status:!0,site_register_smscode_status:!0,site_register_code_type:"sms",site_register_need_username:!1,site_register_need_mobile:!0,site_register_need_mobile_check:!0,site_register_need_email:!1,site_register_need_email_check:!1},s=_({...w}),[g,C]=K(),h=_(""),U=()=>{if(!t.value.mobile){n.error("请输入手机号");return}z()},z=async(u={})=>{const e={screen:"register",mobile:t.value.mobile,...u},a=await P(e);a.code===1?(n.success(a.msg),C()):n.error(a.msg)},N=async()=>{const u={token:h.value,screen:"verify_code",email:t.value.email},e=await $(u);e.code===1?(n.success(e.msg),C()):n.error(e.msg)},t=_({...{username:"",email:"",mobile:"",password:"",checkboxEd:!1,email_code:"",mobile_code:"",invite_code:""}}),m={},T=()=>{s.value.site_register_need_username&&(m.username=[{required:!0,message:"用户名必填",type:"error"}]),s.value.site_register_need_email&&(m.email=[{required:!0,message:"邮箱必填",type:"error"}],m.email.push({email:!0,message:"请输入正确的邮箱",type:"warning"})),s.value.site_register_need_mobile&&(m.mobile=[{required:!0,message:"手机号必填",type:"error"}]),s.value.site_register_need_mobile&&s.value.site_register_need_mobile_check&&(m.mobile_code=[{required:!0,message:"手机验证码必填",type:"error"}]),s.value.site_register_need_email&&s.value.site_register_need_email_check&&(m.email_code=[{required:!0,message:"邮箱验证码必填",type:"error"}]),m.password=[{required:!0,message:"密码必填",type:"error"}]},q=_(),k=_(!1),B=S,D=u=>{if(u.validateResult===!0){if(!t.value.checkboxEd){n.error("请同意注册协议 和 隐私政策");return}O({reginfo:t.value}).then(e=>{e.code===1?(n.success("注册成功"),B("registerSuccess")):n.error(e.msg)}).catch(()=>{n.error("注册失败")})}},I=_(!0);(async()=>{const u=await G(),{code:e,data:a}=u;e===1&&(s.value={...w,...a},T(),I.value=!1)})();const F=()=>{t.value.checkboxEd=!0},A=_(),E=async()=>{await te(),A.value.init(t.value.checkboxEd)};return E(),(u,e)=>{const a=j,f=H,d=Q,x=Y,M=Z,L=X;return l(),V("div",null,[s.value.site_register_status?(l(),V("div",se,[o(L,{ref_key:"form",ref:q,loading:I.value,class:"item-container",data:t.value,rules:m,"label-width":"0",onSubmit:D},{default:r(()=>[s.value.site_register_need_username?(l(),c(d,{key:0,name:"username"},{default:r(()=>[o(f,{modelValue:t.value.username,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value.username=i),type:"text",size:"large",placeholder:"请输入用户名"},{"prefix-icon":r(()=>[o(a,{name:"user"})]),_:1},8,["modelValue"])]),_:1})):p("",!0),s.value.site_register_need_email?(l(),c(d,{key:1,name:"email"},{default:r(()=>[o(f,{modelValue:t.value.email,"onUpdate:modelValue":e[1]||(e[1]=i=>t.value.email=i),type:"text",size:"large",placeholder:"请输入邮箱"},{"prefix-icon":r(()=>[o(a,{name:"mail"})]),_:1},8,["modelValue"])]),_:1})):p("",!0),s.value.site_register_need_email_check&&s.value.site_register_need_email?(l(),c(d,{key:2,name:"email_code",class:"code"},{default:r(()=>[o(f,{modelValue:t.value.email_code,"onUpdate:modelValue":e[2]||(e[2]=i=>t.value.email_code=i),size:"large",placeholder:"请输入邮箱验证码"},{"prefix-icon":r(()=>[o(a,{name:"mail"})]),_:1},8,["modelValue"]),s.value.site_register_need_email_check&&s.value.site_register_need_email?(l(),c(x,{key:0,variant:"outline",disabled:v(g)>0,onClick:N},{default:r(()=>[b(R(v(g)==0?"获取验证码":`${v(g)}秒后可重发`),1)]),_:1},8,["disabled"])):p("",!0)]),_:1})):p("",!0),s.value.site_register_need_mobile?(l(),c(d,{key:3,name:"mobile"},{default:r(()=>[o(f,{modelValue:t.value.mobile,"onUpdate:modelValue":e[3]||(e[3]=i=>t.value.mobile=i),size:"large",placeholder:"请输入您的手机号"},{"prefix-icon":r(()=>[o(a,{name:"mobile"})]),_:1},8,["modelValue"])]),_:1})):p("",!0),s.value.site_register_need_mobile_check&&s.value.site_register_need_mobile?(l(),c(d,{key:4,name:"mobile_code",class:"code"},{default:r(()=>[o(f,{modelValue:t.value.mobile_code,"onUpdate:modelValue":e[4]||(e[4]=i=>t.value.mobile_code=i),size:"large",placeholder:"请输入手机验证码"},{"prefix-icon":r(()=>[o(a,{name:"mobile"})]),_:1},8,["modelValue"]),s.value.site_register_need_mobile_check&&s.value.site_register_need_mobile?(l(),c(x,{key:0,variant:"outline",disabled:v(g)>0,onClick:U},{default:r(()=>[b(R(v(g)==0?"获取验证码":`${v(g)}秒后可重发`),1)]),_:1},8,["disabled"])):p("",!0)]),_:1})):p("",!0),o(d,{name:"password"},{default:r(()=>[o(f,{modelValue:t.value.password,"onUpdate:modelValue":e[6]||(e[6]=i=>t.value.password=i),size:"large",type:k.value?"text":"password",clearable:"",placeholder:"请输入登录密码",autocomplete:" "},{"prefix-icon":r(()=>[o(a,{name:"lock-on"})]),"suffix-icon":r(()=>[o(a,{name:k.value?"browse":"browse-off",onClick:e[5]||(e[5]=i=>k.value=!k.value)},null,8,["name"])]),_:1},8,["modelValue","type"])]),_:1}),o(d,{class:"check-container",name:"checkboxEd",onClick:E},{default:r(()=>[o(M,{modelValue:t.value.checkboxEd,"onUpdate:modelValue":e[7]||(e[7]=i=>t.value.checkboxEd=i)},{default:r(()=>[...e[8]||(e[8]=[b("我已阅读并同意 ",-1)])]),_:1},8,["modelValue"]),e[9]||(e[9]=y("span",null,"服务协议",-1)),e[10]||(e[10]=b(" 和 ",-1)),e[11]||(e[11]=y("span",null," 隐私声明",-1))]),_:1}),o(W,{ref_key:"agreementRef",ref:A,onSuccess:F},null,512),o(x,{block:"",size:"large",type:"submit"},{default:r(()=>[...e[12]||(e[12]=[b(" 注册 ",-1)])]),_:1})]),_:1},8,["loading","data"])])):(l(),V("div",oe,[y("div",re,[y("div",ae,[o(a,{name:"close"}),e[13]||(e[13]=b(" 系统已关闭注册 ",-1))])])]))])}}});const Fe=J(ie,[["__scopeId","data-v-22b860d0"]]);export{Fe as default};
