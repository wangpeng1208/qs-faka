import{r as u,M as c}from"./index-5ae314bf.js";import{_ as A}from"./index.vue_vue_type_script_setup_true_lang-e948e95c.js";import{I as F}from"./index-9b4540ef.js";import{F as M,a as R}from"./index-9de6e4fb.js";import{I as h}from"./index-4e516f6a.js";import{D as q}from"./index-bf58812f.js";import{d as B,A as C,r as f,l as E,V as N,W as m,M as l}from"./vue-d500b9b9.js";function H(s){return u.post({url:"/adminapi/permission/admin/list",params:s})}function J(s){return u.post({url:"/adminapi/permission/admin/delete",params:s})}function P(s){return u.post({url:"/adminapi/permission/admin/edit",params:s})}function S(s){return u.post({url:"/adminapi/permission/admin/detail",params:s})}const j={name:"AdminEditPopup"},K=B({...j,emits:["success"],setup(s,{expose:b,emit:v}){const d={username:"",nickname:"",password:"",avatar:"",email:"",mobile:"",id:""},a=C({...d}),V=({name:n,url:e})=>{a[n]=e},r=f(!1),p=f("添加管理员"),g=n=>{if(n)p.value="编辑管理员",y(n);else{p.value="添加管理员";for(const e in d)a[e]=d[e]}r.value=!0},y=async n=>{const{data:e}=await S({id:n});for(const t in a)e[t]!=null&&e[t]!==void 0&&(t==="role"?a[t]=e[t].map(i=>i.id):a[t]=e[t])};b({init:g});const _=f(null),k={username:[{required:!0,message:"必填",type:"error"}]},w=v,U=async()=>{const n=await _.value.validate();if(typeof n!="object"&&n)try{const e=await P(a);e.code===1?(c.success("操作成功"),r.value=!1,w("success")):c.error(e.msg)}catch(e){c.error(e.msg)}};return(n,e)=>{const t=F,i=M,I=h,x=R,D=q;return E(),N(D,{visible:r.value,"onUpdate:visible":e[5]||(e[5]=o=>r.value=o),"close-on-overlay-click":!1,"destroy-on-close":!0,header:p.value,"on-confirm":U},{default:m(()=>[l(x,{ref_key:"formRef",ref:_,"label-align":"left",data:a,rules:k,"label-width":80},{default:m(()=>[l(i,{label:"用户名",name:"username"},{default:m(()=>[l(t,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=o=>a.username=o),clearable:"",placeholder:"请输入管理员用户名"},null,8,["modelValue"])]),_:1}),l(i,{label:"昵称",name:"nickname"},{default:m(()=>[l(t,{modelValue:a.nickname,"onUpdate:modelValue":e[1]||(e[1]=o=>a.nickname=o),clearable:"",placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1}),l(i,{label:"密码",name:"password"},{default:m(()=>[l(t,{modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=o=>a.password=o),clearable:"",placeholder:"留空则不更改"},null,8,["modelValue"])]),_:1}),l(i,{label:"头像",name:"avatar"},{default:m(()=>[l(A,{theme:"image",app:"admin",initial:a,name:"avatar",data:{type:"image"},onUpdate:V},null,8,["initial"])]),_:1}),l(i,{label:"邮箱",name:"email"},{default:m(()=>[l(t,{modelValue:a.email,"onUpdate:modelValue":e[3]||(e[3]=o=>a.email=o),clearable:"",placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(i,{label:"手机",name:"mobile"},{default:m(()=>[l(I,{modelValue:a.mobile,"onUpdate:modelValue":e[4]||(e[4]=o=>a.mobile=o),clearable:"",placeholder:"请输入手机",style:{width:"500px"},theme:"column",min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])}}});export{K as _,J as d,H as l};
